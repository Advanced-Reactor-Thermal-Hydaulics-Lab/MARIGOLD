<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MARIGOLD.extracts_and_loads &#8212; MARIGOLD 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=470960a4" />
    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for MARIGOLD.extracts_and_loads</h1><div class="highlight"><pre>
<span></span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.config</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.Condition</span><span class="w"> </span><span class="kn">import</span> <span class="n">Condition</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.Iskandrani_Condition</span><span class="w"> </span><span class="kn">import</span> <span class="n">Iskandrani_Condition</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.Yang_Condition</span><span class="w"> </span><span class="kn">import</span> <span class="n">Yang_Condition</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xlrd</span>

<div class="viewcode-block" id="extractProbeData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.extractProbeData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extractProbeData</span><span class="p">(</span><span class="n">dump_file</span> <span class="o">=</span> <span class="s1">&#39;database.dat&#39;</span><span class="p">,</span> <span class="n">in_dir</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">require_terms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">skip_terms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CFD&#39;</span><span class="p">,</span> <span class="s1">&#39;Copy&#39;</span><span class="p">],</span>
                     <span class="n">extract_Ryan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">Ryan_path</span> <span class="o">=</span> <span class="s1">&#39;Z:</span><span class="se">\\</span><span class="s1">TRSL</span><span class="se">\\</span><span class="s1">PITA</span><span class="se">\\</span><span class="s1">Data</span><span class="se">\\</span><span class="s1">LocalData</span><span class="se">\\</span><span class="s1">spreadsheets</span><span class="se">\\</span><span class="s1">PITA&#39;</span><span class="p">,</span>
                     <span class="n">extract_Kong</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">Kong_path</span> <span class="o">=</span> <span class="s1">&#39;Z:</span><span class="se">\\</span><span class="s1">TRSL</span><span class="se">\\</span><span class="s1">PITA</span><span class="se">\\</span><span class="s1">Data</span><span class="se">\\</span><span class="s1">LocalData</span><span class="se">\\</span><span class="s1">spreadsheets</span><span class="se">\\</span><span class="s1">101.6mm&#39;</span><span class="p">,</span>
                     <span class="n">extract_Talley</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">Talley_path</span> <span class="o">=</span> <span class="s1">&#39;Z:</span><span class="se">\\</span><span class="s1">TRSL</span><span class="se">\\</span><span class="s1">PITA</span><span class="se">\\</span><span class="s1">Data</span><span class="se">\\</span><span class="s1">LocalData</span><span class="se">\\</span><span class="s1">spreadsheets</span><span class="se">\\</span><span class="s1">38.1mm&#39;</span><span class="p">,</span>
                     <span class="n">extract_Yadav</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">Yadav_path</span> <span class="o">=</span> <span class="s1">&#39;Z:</span><span class="se">\\</span><span class="s1">TRSL</span><span class="se">\\</span><span class="s1">PITA</span><span class="se">\\</span><span class="s1">Data</span><span class="se">\\</span><span class="s1">LocalData</span><span class="se">\\</span><span class="s1">spreadsheets</span><span class="se">\\</span><span class="s1">50.8mm&#39;</span>
                     <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">all_conditions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">### PITA Data ###</span>

    <span class="k">if</span> <span class="n">extract_Ryan</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Ryan_path</span>

        <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">33</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">82</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">108</span><span class="p">,</span> <span class="mi">133</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">182</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">208</span><span class="p">,</span> <span class="mi">233</span><span class="p">)]</span> <span class="p">]))</span>
        <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">82</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">108</span><span class="p">,</span> <span class="mi">133</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">182</span><span class="p">)]</span> <span class="p">]))</span>

        <span class="c1">#print(Q1_ranges, Q2_ranges)</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
                
                <span class="c1"># Check if the file has any skipped/required terms</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">skip_terms</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">require_terms</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">term</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">require_terms</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        <span class="k">continue</span>
                
                <span class="c1">#if debug: print(path, file=debugFID)</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading wb: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">Skipping...&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf&#39;</span><span class="p">))</span>
                    <span class="n">jgref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg&#39;</span><span class="p">))</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: Non-standard excel file name </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Skipping...&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
                <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;U23&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="s1">&#39;Ryan&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>
                
                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;G266&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                
                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q1_ranges</span><span class="p">:</span>
                    <span class="n">first_phi</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;K</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column A could not be floatified. Skipping...&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;BD</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">first_phi</span><span class="p">:</span>
                                    <span class="k">pass</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not my first phi, for some reaseon&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">first_phi</span> <span class="o">=</span> <span class="kc">False</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>


                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q2_ranges</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;DC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;CO</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column A could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;CO</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;ER</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>

    
    <span class="c1">### 38.1 mm data (Talley) ###</span>

    <span class="k">if</span> <span class="n">extract_Talley</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Talley_path</span>
        <span class="c1">#print(Q1_ranges, Q2_ranges)</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
                
                <span class="c1"># Check if the file has any skipped/required terms</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">skip_terms</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">require_terms</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="c1">#if debug: print(path, file=debugFID)</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading wb: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">Skipping...&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf&#39;</span><span class="p">))</span>
                    <span class="n">jgref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg&#39;</span><span class="p">))</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: Non-standard excel file name </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Skipping...&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">old</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="c1">#print(f&quot;Warning: Old format file {file}&quot;)</span>
                    <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">old</span> <span class="o">=</span> <span class="kc">True</span>
                

                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="s1">&#39;Talley&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>
                
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                
                <span class="n">phi_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="nb">next</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">while</span> <span class="n">phi_counter</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;E</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span> <span class="ow">or</span>  <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;found header in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        <span class="nb">next</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">continue</span>

                    <span class="k">if</span> <span class="nb">next</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># Hopefully in the part of the sheet with data</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="c1"># Done reading data</span>
                            <span class="n">phi_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="nb">next</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">continue</span>


                        <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">old</span> <span class="ow">and</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;F</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="c1"># use old tab keys</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;AA</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">old_tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, old tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">old_tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;old tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;K</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="c1"># use new tab keys</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;BD</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                        <span class="n">phi</span> <span class="o">=</span> <span class="n">phis</span><span class="p">[</span><span class="n">phi_counter</span><span class="p">]</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                            <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>

                <span class="c1">#print(&#39;total rows read:&#39;, i)</span>

    <span class="c1">### 101.6mm Data ###</span>

    <span class="k">if</span> <span class="n">extract_Kong</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Kong_path</span>
        <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">33</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">82</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">108</span><span class="p">,</span> <span class="mi">133</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">182</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">208</span><span class="p">,</span> <span class="mi">233</span><span class="p">)]</span> <span class="p">]))</span>
        <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">82</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">108</span><span class="p">,</span> <span class="mi">133</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">182</span><span class="p">)]</span> <span class="p">]))</span>

        <span class="c1">#print(Q1_ranges, Q2_ranges)</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
                
                <span class="c1"># Check if the file has any skipped/required terms</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">skip_terms</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">require_terms</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="c1">#if debug: print(path, file=debugFID)</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading wb: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">Skipping...&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf&#39;</span><span class="p">))</span>
                    <span class="n">jgref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg&#39;</span><span class="p">))</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: Non-standard excel file name </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Skipping...&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;U23&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: no sheet &quot;1&quot; found for </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Using sheet &quot;2&quot; C2 for jgloc&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                

                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="s1">&#39;Kong&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>
                
                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;G266&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                
                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q1_ranges</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;K</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column A could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;BD</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>


                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q2_ranges</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;DC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;CN</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column A could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;CN</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;EQ</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                
    
    <span class="c1">### Yadav Data ###</span>

    <span class="k">if</span> <span class="n">extract_Yadav</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Yadav_path</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reading Yadav&#39;s data&quot;</span><span class="p">)</span>
        <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">29</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">74</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">121</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">145</span><span class="p">,</span> <span class="mi">166</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="mi">213</span><span class="p">)]</span> <span class="p">]))</span>
        <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">74</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">121</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">145</span><span class="p">,</span> <span class="mi">166</span><span class="p">)]</span> <span class="p">]))</span>

        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
                
                <span class="c1"># Check if the file has any skipped/required terms</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">skip_terms</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">term</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">require_terms</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="c1">#if debug: print(path, file=debugFID)</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading wb: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">Skipping...&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf&#39;</span><span class="p">))</span>
                    <span class="n">jgref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg&#39;</span><span class="p">))</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
                    <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: Non-standard excel file name </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Skipping...&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>

                <span class="c1"># jglocs = [&#39;O16&#39;, &#39;O17&#39;, &#39;O18&#39;, &#39;O19&#39;, &#39;O20&#39;]</span>
                <span class="c1"># jgloc = ws[jglocs[int(port.strip(&#39;P&#39;))-1]].value</span>
                <span class="n">jgloc</span> <span class="o">=</span> <span class="n">jgref</span>
                
                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="s1">&#39;Yadav&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>
                
                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;G246&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                
                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q1_ranges</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AA</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AA</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mf">0.0064</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AD</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mf">13.45</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AY</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mf">1.682</span><span class="p">):</span>
                                <span class="c1"># It&#39;s dummy data, skip it</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dummy data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Skipping...&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column A could not be floatified. Skipping...&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;BD</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;---&#39;</span><span class="p">:</span>
                                    <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                                <span class="k">elif</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;None found in </span><span class="si">{</span><span class="n">cell</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                    <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>


            <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q2_ranges</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;DR</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;CP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column A could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                            <span class="k">continue</span>
                        
                        <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;CP</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;ES</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;---&#39;</span><span class="p">:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;None found in </span><span class="si">{</span><span class="n">cell</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
                        
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                            <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span> 

    <span class="k">if</span> <span class="n">debug</span> <span class="ow">and</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
            <span class="n">cond</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dump_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">all_conditions</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">return</span></div>



<div class="viewcode-block" id="extractLocalDataFromDir">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.extractLocalDataFromDir">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extractLocalDataFromDir</span><span class="p">(</span><span class="n">path</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">dump_file</span> <span class="o">=</span> <span class="s1">&#39;database.dat&#39;</span><span class="p">,</span> <span class="n">in_dir</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">require_terms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;jf&#39;</span><span class="p">],</span> 
                            <span class="n">skip_terms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CFD&#39;</span><span class="p">,</span> <span class="s1">&#39;Copy&#39;</span><span class="p">],</span> <span class="n">sheet_type</span> <span class="o">=</span> <span class="s1">&#39;adix_template&#39;</span><span class="p">,</span> <span class="n">append_to_json</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">pitot_sheet</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">print_sheets</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function for getting all local data from spreadsheets in a directory, path</span>

<span class="sd">       Does not recursively descend, only checks in the path given</span>
<span class="sd">    </span>
<span class="sd">       Still under construction, but should support sheet types</span>
<span class="sd">        - &#39;adix_template4&#39;</span>
<span class="sd">        - &#39;ryan_template&#39;</span>
<span class="sd">        - &#39;adix_template&#39; (maybe rename this quan_template)</span>
<span class="sd">        - &#39;bettis_template&#39;</span>
<span class="sd">        - &#39;talley_template&#39;</span>
<span class="sd">        - &#39;yadav_template&#39;</span>

<span class="sd">       Also can try to infer the sheet type, xlsm will be adix_template4, if it has P5, 6, or 7 it will</span>
<span class="sd">       be classified as an adix_template, different angles ryan, etc. The inference can also be made by </span>
<span class="sd">       appending _adix or _quan or _ryan to the excel sheets being processed</span>

<span class="sd">       Custom sheet types may be supported, but they still have to generally follow the classic template</span>
<span class="sd">       structure. The setup information has to be in sheet &#39;1&#39; and all the local data in sheet &#39;2&#39;. Ranges</span>
<span class="sd">       must be specified as a list of lists</span>

<span class="sd">       Q1_ranges = [[angle1, [index1, index2.,..]], [angle2, [index1, index2.,..]], ...]</span>

<span class="sd">       with the starts and ends</span>

<span class="sd">       [Q1_start, Q1_end, Q2_start, ...]</span>

<span class="sd">       Add on pitot starts/ends if pitot_sheet = True</span>

<span class="sd">       Need to specify Q1_check, Q2_check, etc. as well</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_conditions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    
        <span class="c1"># print(file)</span>
        <span class="k">if</span> <span class="n">print_sheets</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span> <span class="ow">or</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsm&#39;</span> <span class="ow">or</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xls&#39;</span><span class="p">:</span>

            <span class="c1"># Check if the file has any skipped/required terms</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">skip_terms</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># if all(term not in file for term in require_terms):</span>
            <span class="c1">#     if debug: print(f&quot;Skipping {file}&quot;, file=debugFID)</span>
            <span class="c1">#     continue</span>
            
            <span class="c1"># if debug: print(path, file=debugFID)</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xls&#39;</span><span class="p">:</span>
                    <span class="n">wb</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                    
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading wb: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">Skipping...&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf&#39;</span><span class="p">))</span>
                <span class="n">jgref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg&#39;</span><span class="p">))</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.xlsm&#39;</span><span class="p">)</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: Non-standard excel file name </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Is this Bettis template?&#39;</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;bettis_template&#39;</span> <span class="ow">and</span> <span class="s1">&#39;Run&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes, it is. Proceeding...&quot;</span><span class="p">)</span>

                    <span class="n">theta</span> <span class="o">=</span> <span class="mi">90</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">port_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span><span class="n">port</span><span class="p">)))</span>
                
                    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run1&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">0.32</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.047</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run2&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">0.95</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.047</span>

                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">2</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run3&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">1.89</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.095</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">3</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run4&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">0.95</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.187</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">4</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run5&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">1.89</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.193</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">5</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run6&#39;</span> <span class="ow">and</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">0.63</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.279</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">6</span>
                        
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ommitting short runs...&quot;</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run7&#39;</span> <span class="ow">and</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">2.84</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.287</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">7</span>

                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ommitting short runs...&quot;</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run6&#39;</span> <span class="ow">and</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">0.63</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.279</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">8</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run7&#39;</span> <span class="ow">and</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;long&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">2.84</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.287</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">9</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run8&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">1.89</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.385</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">10</span>
                    <span class="k">elif</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Run9&#39;</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="mf">4.40</span>
                        <span class="n">jgref</span> <span class="o">=</span> <span class="mf">0.940</span>
                        
                        <span class="n">run_idx</span> <span class="o">=</span> <span class="mi">11</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Run number exceeds highest known run. Skipping...&quot;</span><span class="p">)</span>
                        <span class="k">continue</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Nope. Skipping...&#39;</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="c1"># print(jf, jgref, port, theta)</span>
            <span class="c1">############################################################################################################################</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">#                                                       BETTIS DATA                                                        #</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">############################################################################################################################</span>
            <span class="k">if</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;bettis_template&#39;</span><span class="p">:</span>

<span class="w">                </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                # Sourced from Kim_Research_BubbleDoc\Bettis\OneGroupEvaluation\AllConditions</span>
<span class="sd">                jgloc_mat = [</span>
<span class="sd">                    [0.047 , 0.040 , 0.040 , 0.040 , None  , None  ],   # Run1</span>
<span class="sd">                    [0.047 , 0.040 , 0.040 , 0.040 , None  , None  ],   # Run2</span>
<span class="sd">                    [0.095 , 0.070 , 0.070 , 0.070 , None  , None  ],   # Run3</span>
<span class="sd">                    [0.187 , 0.140 , 0.150 , 0.150 , None  , None  ],   # Run4</span>
<span class="sd">                    [0.193 , 0.140 , 0.150 , 0.150 , None  , None  ],   # Run5</span>
<span class="sd">                    [0.279 , 0.220 , None  , 0.220 , None  , None  ],   # Run6_short</span>
<span class="sd">                    [0.287 , 0.210 , 0.220 , 0.220 , None  , None  ],   # Run7_short</span>
<span class="sd">                    [None  , 0.219 , None  , 0.234 , None  , 0.251 ],   # Run6_long</span>
<span class="sd">                    [None  , 0.212 , None  , None  , None  , 0.264 ],   # Run7_long</span>
<span class="sd">                    [None  , 0.288 , None  , 0.314 , None  , 0.346 ],   # Run8</span>
<span class="sd">                    [None  , 0.618 , None  , 0.716 , None  , 0.850 ],   # Run9</span>
<span class="sd">                ]</span>

<span class="sd">                alpha_mat = [</span>
<span class="sd">                    [0.066 , 0.089 , 0.080 , 0.083 , None  , None  ],   # Run1</span>
<span class="sd">                    [0.039 , 0.038 , 0.037 , 0.034 , None  , None  ],   # Run2</span>
<span class="sd">                    [0.035 , 0.038 , 0.031 , 0.034 , None  , None  ],   # Run3</span>
<span class="sd">                    [0.104 , 0.110 , 0.116 , 0.116 , None  , None  ],   # Run4</span>
<span class="sd">                    [0.064 , 0.059 , 0.062 , 0.059 , None  , None  ],   # Run5</span>
<span class="sd">                    [0.220 , 0.173 , None  , 0.248 , None  , None  ],   # Run6_short</span>
<span class="sd">                    [0.031 , 0.051 , None  , 0.058 , None  , None  ],   # Run7_short</span>
<span class="sd">                    [None  , 0.207 , None  , 0.222 , None  , 0.237 ],   # Run6_long</span>
<span class="sd">                    [None  , 0.067 , None  , None  , None  , 0.075 ],   # Run7_long</span>
<span class="sd">                    [None  , 0.121 , None  , 0.103 , None  , 0.124 ],   # Run8</span>
<span class="sd">                    [None  , 0.078 , None  , 0.095 , None  , 0.125 ]    # Run9</span>
<span class="sd">                ]</span>

<span class="sd">                ai_mat = [</span>
<span class="sd">                    [None  , 190.33, 175.51, 173.26, None  , None  ],   # Run1</span>
<span class="sd">                    [None  , 78.90 , 77.30 , 71.10 , None  , None  ],   # Run2</span>
<span class="sd">                    [None  , 87.80 , 76.70 , 78.60 , None  , None  ],   # Run3</span>
<span class="sd">                    [None  , 210.56, 223.89, 211.69, None  , None  ],   # Run4</span>
<span class="sd">                    [None  , 125.06, 135.80, 120.97, None  , None  ],   # Run5</span>
<span class="sd">                    [None  , 432.78, None  , 372.21, None  , None  ],   # Run6_short</span>
<span class="sd">                    [None  , 151.23, None  , 157.03, None  , None  ],   # Run7_short</span>
<span class="sd">                    [None  , 470.61, None  , 369.69, None  , 418.74],   # Run6_long</span>
<span class="sd">                    [None  , 199.34, None  , None  , None  , 222.64],   # Run7_long</span>
<span class="sd">                    [None  , 209.62, None  , 192.28, None  , 270.00],   # Run8</span>
<span class="sd">                    [None  , 188.53, None  , 258.80, None  , 345.16],   # Run9</span>
<span class="sd">                ]</span>

<span class="sd">                Dsm_mat = [</span>
<span class="sd">                    [None  , 2.56  , None  , 2.61  , None  , None  ],   # Run1</span>
<span class="sd">                    [None  , 2.87  , None  , 2.71  , None  , None  ],   # Run2</span>
<span class="sd">                    [None  , 2.55  , None  , 2.59  , None  , None  ],   # Run3</span>
<span class="sd">                    [None  , 3.06  , None  , 3.06  , None  , None  ],   # Run4</span>
<span class="sd">                    [None  , 2.92  , None  , 2.92  , None  , None  ],   # Run5</span>
<span class="sd">                    [None  , 2.33  , None  , 3.81  , None  , None  ],   # Run6_short</span>
<span class="sd">                    [None  , 2.03  , None  , 2.21  , None  , None  ],   # Run7_short</span>
<span class="sd">                    [None  , 2.61  , None  , 3.54  , None  , 3.28  ],   # Run6_long</span>
<span class="sd">                    [None  , 1.98  , None  , None  , None  , 2.01  ],   # Run7_long, last one at 140.1 L/D</span>
<span class="sd">                    [None  , 2.67  , None  , 3.26  , None  , 2.78  ],   # Run8</span>
<span class="sd">                    [None  , 2.43  , None  , 2.19  , None  , 2.18  ],   # Run9</span>
<span class="sd">                ]</span>

<span class="sd">                # Sourced from thesis Table A.E.(a), and MATLAB initcond.m</span>
<span class="sd">                pz_mat = [</span>
<span class="sd">                    [None  , 30603.60 , 27710.01 , 24816.42 , None  , None    ],  # Run1</span>
<span class="sd">                    [None  , 32735.69 , 29567.55 , 26399.42 , None  , None    ],  # Run2</span>
<span class="sd">                    [None  , 35073.44 , 31433.39 , 27793.33 , None  , None    ],  # Run3</span>
<span class="sd">                    [None  , 31486.61 , 28501.50 , 25516.40 , None  , None    ],  # Run4</span>
<span class="sd">                    [None  , 38464.37 , 34860.21 , 31256.04 , None  , None    ],  # Run5</span>
<span class="sd">                    [None  , 29584.83 , 27028.58 , 24472.33 , None  , None    ],  # Run6_short</span>
<span class="sd">                    [None  , 36275.59 , 32140.29 , 28004.99 , None  , None    ],  # Run7_short</span>
<span class="sd">                    [None  , 28213.762, None     , 19814.36 , None  , 11415   ],  # Run6_long</span>
<span class="sd">                    [None  , 40150.62 , None     , 25970.05 , None  , 11789.5 ],  # Run7_long</span>
<span class="sd">                    [None  , 34289.443, None     , 22869.15 , None  , 11448.8 ],  # Run8</span>
<span class="sd">                    [None  , 52254.526, None     , 31247.62 , None  , 10240.7 ],  # Run9</span>
<span class="sd">                ]</span>

<span class="sd">                LoverD_mat = [8.02, 34.76, 61.49, 88.22, 114.96, 141.70]</span>
<span class="sd">                dpdz_mat = [9250.38, 10128.04, 11636.70, 9542.94, 11521.98, 8171.95, 13219.94, 8267.13, 13957.25, 11240.45, 20676.09]</span>
<span class="sd">                &#39;&#39;&#39;</span>

                <span class="c1"># Sourced from \Kim_ThesisFolder\Thesis_Original\OneGroupEvaluation\AllConditions</span>
                <span class="n">jgloc_mat</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">[</span><span class="mf">0.047</span> <span class="p">,</span> <span class="mf">0.040</span> <span class="p">,</span> <span class="mf">0.040</span> <span class="p">,</span> <span class="mf">0.040</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run1</span>
                    <span class="p">[</span><span class="mf">0.047</span> <span class="p">,</span> <span class="mf">0.040</span> <span class="p">,</span> <span class="mf">0.040</span> <span class="p">,</span> <span class="mf">0.040</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run2</span>
                    <span class="p">[</span><span class="mf">0.095</span> <span class="p">,</span> <span class="mf">0.070</span> <span class="p">,</span> <span class="mf">0.070</span> <span class="p">,</span> <span class="mf">0.070</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run3</span>
                    <span class="p">[</span><span class="mf">0.187</span> <span class="p">,</span> <span class="mf">0.140</span> <span class="p">,</span> <span class="mf">0.150</span> <span class="p">,</span> <span class="mf">0.150</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run4</span>
                    <span class="p">[</span><span class="mf">0.193</span> <span class="p">,</span> <span class="mf">0.140</span> <span class="p">,</span> <span class="mf">0.150</span> <span class="p">,</span> <span class="mf">0.150</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run5</span>
                    <span class="p">[</span><span class="mf">0.279</span> <span class="p">,</span> <span class="mf">0.220</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.220</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run6_short</span>
                    <span class="p">[</span><span class="mf">0.287</span> <span class="p">,</span> <span class="mf">0.210</span> <span class="p">,</span> <span class="mf">0.220</span> <span class="p">,</span> <span class="mf">0.220</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run7_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.28</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.234</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.251</span> <span class="p">],</span>   <span class="c1"># Run6_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.3</span>   <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.264</span> <span class="p">],</span>   <span class="c1"># Run7_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.385</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.314</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.346</span> <span class="p">],</span>   <span class="c1"># Run8</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.94</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.716</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.850</span> <span class="p">],</span>   <span class="c1"># Run9</span>
                <span class="p">]</span>

                <span class="n">alpha_mat</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">[</span><span class="mf">0.066</span> <span class="p">,</span> <span class="mf">0.0839</span><span class="p">,</span> <span class="mf">0.080</span> <span class="p">,</span> <span class="mf">0.083</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run1</span>
                    <span class="p">[</span><span class="mf">0.039</span> <span class="p">,</span> <span class="mf">0.038</span> <span class="p">,</span> <span class="mf">0.037</span> <span class="p">,</span> <span class="mf">0.034</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run2</span>
                    <span class="p">[</span><span class="mf">0.035</span> <span class="p">,</span> <span class="mf">0.038</span> <span class="p">,</span> <span class="mf">0.031</span> <span class="p">,</span> <span class="mf">0.034</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run3</span>
                    <span class="p">[</span><span class="mf">0.104</span> <span class="p">,</span> <span class="mf">0.1097</span><span class="p">,</span> <span class="mf">0.116</span> <span class="p">,</span> <span class="mf">0.116</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run4</span>
                    <span class="p">[</span><span class="mf">0.064</span> <span class="p">,</span> <span class="mf">0.0592</span><span class="p">,</span> <span class="mf">0.062</span> <span class="p">,</span> <span class="mf">0.059</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run5</span>
                    <span class="p">[</span><span class="mf">0.220</span> <span class="p">,</span> <span class="mf">0.1727</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.248</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run6_short</span>
                    <span class="p">[</span><span class="mf">0.031</span> <span class="p">,</span> <span class="mf">0.051</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.058</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run7_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.2068</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.222</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.237</span> <span class="p">],</span>   <span class="c1"># Run6_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.0674</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.075</span> <span class="p">],</span>   <span class="c1"># Run7_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.1149</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.103</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.124</span> <span class="p">],</span>   <span class="c1"># Run8</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.0782</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.095</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">0.125</span> <span class="p">]</span>    <span class="c1"># Run9</span>
                <span class="p">]</span>

                <span class="n">ai_mat</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">190.33</span><span class="p">,</span> <span class="mf">175.51</span><span class="p">,</span> <span class="mf">173.26</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run1</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">82.28</span> <span class="p">,</span> <span class="mf">77.30</span> <span class="p">,</span> <span class="mf">71.10</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run2</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">87.70</span> <span class="p">,</span> <span class="mf">76.70</span> <span class="p">,</span> <span class="mf">78.60</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run3</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">210.56</span><span class="p">,</span> <span class="mf">223.89</span><span class="p">,</span> <span class="mf">211.69</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run4</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">125.06</span><span class="p">,</span> <span class="mf">135.80</span><span class="p">,</span> <span class="mf">120.97</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run5</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">432.78</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">372.21</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run6_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">151.23</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">157.03</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run7_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">470.61</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">369.69</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">418.74</span><span class="p">],</span>   <span class="c1"># Run6_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">199.34</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">222.64</span><span class="p">],</span>   <span class="c1"># Run7_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">209.62</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">192.28</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">270.00</span><span class="p">],</span>   <span class="c1"># Run8</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">188.53</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">258.80</span><span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">345.16</span><span class="p">],</span>   <span class="c1"># Run9</span>
                <span class="p">]</span>

                <span class="n">Dsm_mat</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.56</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.61</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run1</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.87</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.71</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run2</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.55</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.59</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run3</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">3.06</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">3.06</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run4</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.92</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.92</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run5</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.33</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">3.81</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run6_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.03</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.21</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">],</span>   <span class="c1"># Run7_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.61</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">3.54</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">3.28</span>  <span class="p">],</span>   <span class="c1"># Run6_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">1.98</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.01</span>  <span class="p">],</span>   <span class="c1"># Run7_long, last one at 140.1 L/D</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.67</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">3.26</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.78</span>  <span class="p">],</span>   <span class="c1"># Run8</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.43</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.19</span>  <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">2.18</span>  <span class="p">],</span>   <span class="c1"># Run9</span>
                <span class="p">]</span>

                <span class="c1"># Sourced from thesis Table A.E.(a), and MATLAB initcond.m</span>
                <span class="n">pz_mat</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">30603.60</span> <span class="p">,</span> <span class="mf">27710.01</span> <span class="p">,</span> <span class="mf">24816.42</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>    <span class="p">],</span>  <span class="c1"># Run1</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">32735.69</span> <span class="p">,</span> <span class="mf">29567.55</span> <span class="p">,</span> <span class="mf">26399.42</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>    <span class="p">],</span>  <span class="c1"># Run2</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">35073.44</span> <span class="p">,</span> <span class="mf">31433.39</span> <span class="p">,</span> <span class="mf">27793.33</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>    <span class="p">],</span>  <span class="c1"># Run3</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">31486.61</span> <span class="p">,</span> <span class="mf">28501.50</span> <span class="p">,</span> <span class="mf">25516.40</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>    <span class="p">],</span>  <span class="c1"># Run4</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">38464.37</span> <span class="p">,</span> <span class="mf">34860.21</span> <span class="p">,</span> <span class="mf">31256.04</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>    <span class="p">],</span>  <span class="c1"># Run5</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">29584.83</span> <span class="p">,</span> <span class="mf">27028.58</span> <span class="p">,</span> <span class="mf">24472.33</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>    <span class="p">],</span>  <span class="c1"># Run6_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">36275.59</span> <span class="p">,</span> <span class="mf">32140.29</span> <span class="p">,</span> <span class="mf">28004.99</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="kc">None</span>    <span class="p">],</span>  <span class="c1"># Run7_short</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">28213.762</span><span class="p">,</span> <span class="kc">None</span>     <span class="p">,</span> <span class="mf">19814.36</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mi">11415</span>   <span class="p">],</span>  <span class="c1"># Run6_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">40150.62</span> <span class="p">,</span> <span class="kc">None</span>     <span class="p">,</span> <span class="mf">25970.05</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">11789.5</span> <span class="p">],</span>  <span class="c1"># Run7_long</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">34289.443</span><span class="p">,</span> <span class="kc">None</span>     <span class="p">,</span> <span class="mf">22869.15</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">11448.8</span> <span class="p">],</span>  <span class="c1"># Run8</span>
                    <span class="p">[</span><span class="kc">None</span>  <span class="p">,</span> <span class="mf">52254.526</span><span class="p">,</span> <span class="kc">None</span>     <span class="p">,</span> <span class="mf">31247.62</span> <span class="p">,</span> <span class="kc">None</span>  <span class="p">,</span> <span class="mf">10240.7</span> <span class="p">],</span>  <span class="c1"># Run9</span>
                <span class="p">]</span>

                <span class="n">LoverD_mat</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.02</span><span class="p">,</span> <span class="mf">34.76</span><span class="p">,</span> <span class="mf">61.49</span><span class="p">,</span> <span class="mf">88.22</span><span class="p">,</span> <span class="mf">114.96</span><span class="p">,</span> <span class="mf">141.70</span><span class="p">]</span>
                <span class="n">dpdz_mat</span> <span class="o">=</span> <span class="p">[</span><span class="mf">9250.38</span><span class="p">,</span> <span class="mf">10128.04</span><span class="p">,</span> <span class="mf">11636.70</span><span class="p">,</span> <span class="mf">9542.94</span><span class="p">,</span> <span class="mf">11521.98</span><span class="p">,</span> <span class="mf">8171.95</span><span class="p">,</span> <span class="mf">13219.94</span><span class="p">,</span> <span class="mf">8267.13</span><span class="p">,</span> <span class="mf">13957.25</span><span class="p">,</span> <span class="mf">11240.45</span><span class="p">,</span> <span class="mf">20676.09</span><span class="p">]</span>


                <span class="n">jgloc</span>                   <span class="o">=</span> <span class="n">jgloc_mat</span><span class="p">[</span><span class="n">run_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">port_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">area_avg_void_sheet</span>     <span class="o">=</span> <span class="n">alpha_mat</span><span class="p">[</span><span class="n">run_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">port_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">area_avg_ai_sheet</span>       <span class="o">=</span> <span class="n">ai_mat</span><span class="p">[</span><span class="n">run_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">port_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">area_avg_Dsm_sheet</span>      <span class="o">=</span> <span class="n">Dsm_mat</span><span class="p">[</span><span class="n">run_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">port_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">pz</span>                      <span class="o">=</span> <span class="n">pz_mat</span><span class="p">[</span><span class="n">run_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">port_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">101330</span>
                <span class="n">LoverD</span>                  <span class="o">=</span> <span class="n">LoverD_mat</span><span class="p">[</span><span class="n">port_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">dpdz</span>                    <span class="o">=</span> <span class="n">dpdz_mat</span><span class="p">[</span><span class="n">run_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                
                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">sheet_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">Dh</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mf">0.20</span> <span class="o">*</span> <span class="mf">0.01</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.20</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">)</span>        <span class="c1"># 1 x 20 cm^2 rectangular channel</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">area_avg_void_sheet</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_ai_sheet</span> <span class="o">=</span> <span class="n">area_avg_ai_sheet</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_Dsm_sheet</span> <span class="o">=</span> <span class="n">area_avg_Dsm_sheet</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">pz</span> <span class="o">=</span> <span class="n">pz</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="n">LoverD</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">dpdz</span> <span class="o">=</span> <span class="n">dpdz</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">jgatm</span> <span class="o">=</span> <span class="n">jgloc</span> <span class="o">*</span> <span class="n">pz</span> <span class="o">/</span> <span class="mi">101330</span>        <span class="c1"># It&#39;s important that P_atm is 101330 if you want to match with old results</span>
            
            <span class="c1">############################################################################################################################</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">#                                                       TALLEY DATA                                                        #</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">############################################################################################################################</span>
            <span class="k">elif</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;talley_template&#39;</span><span class="p">:</span>
                <span class="c1">#print(Q1_ranges, Q2_ranges)</span>
                
                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>
                <span class="n">jgatm</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="n">old</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="n">jgloc</span> <span class="o">=</span> <span class="n">jgref</span>
                
                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgatm</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="s1">&#39;Talley&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>
                
                <span class="n">cond</span><span class="o">.</span><span class="n">jgatm</span> <span class="o">=</span> <span class="n">jgatm</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">=</span> <span class="n">jgloc</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B206&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_ai_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C206&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                
                <span class="c1">########################################################################################################################</span>
                <span class="c1"># Q1</span>

                <span class="n">phis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">phi_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="nb">next</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">while</span> <span class="n">phi_counter</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;E</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span> <span class="ow">or</span>  <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;found header in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        <span class="nb">next</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">continue</span>

                    <span class="k">if</span> <span class="nb">next</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># Hopefully in the part of the sheet with data</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="c1"># Done reading data</span>
                            <span class="n">phi_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="nb">next</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">continue</span>

                        <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">old</span> <span class="ow">and</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;F</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;AA</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">old_tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, old tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">old_tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;old tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;K</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;BD</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                        <span class="n">phi</span> <span class="o">=</span> <span class="n">phis</span><span class="p">[</span><span class="n">phi_counter</span><span class="p">]</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>

                <span class="c1">########################################################################################################################</span>
                <span class="c1"># Q2</span>
                <span class="n">phis</span> <span class="o">=</span> <span class="p">[</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">]</span>

                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">phi_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="nb">next</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">while</span> <span class="n">phi_counter</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AS</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;Spherical&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;found header in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        <span class="nb">next</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">continue</span>

                    <span class="k">if</span> <span class="nb">next</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># Hopefully in the part of the sheet with data</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AQ</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="c1"># Done reading data</span>
                            <span class="n">phi_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="nb">next</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">continue</span>

                        <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">old</span> <span class="ow">and</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AV</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;AQ</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;BQ</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">old_tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">old_tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, old tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">old_tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;old tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        
                        <span class="n">phi</span> <span class="o">=</span> <span class="n">phis</span><span class="p">[</span><span class="n">phi_counter</span><span class="p">]</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>

            <span class="c1">############################################################################################################################</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">#                                                       YADAV DATA                                                         #</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">############################################################################################################################</span>
            <span class="k">elif</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;yadav_template&#39;</span><span class="p">:</span>

                <span class="n">potent_ranges</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">22</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">62</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">87</span><span class="p">,</span> <span class="mi">101</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">142</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">168</span><span class="p">,</span> <span class="mi">182</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">209</span><span class="p">,</span> <span class="mi">223</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">264</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">304</span><span class="p">)]</span> <span class="p">]</span>
                
                <span class="c1"># ID is going to be at A1, A41, A80, A121, A161, A202, A243, A283</span>
                <span class="c1"># jgatm C3</span>
                <span class="c1"># jf C4</span>

                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>

                <span class="n">jgatm</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="n">jgref</span> <span class="o">=</span> <span class="n">jgatm</span>

                <span class="n">jglocs</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="n">jgloc</span> <span class="o">=</span> <span class="n">jgatm</span>       <span class="c1"># Nope. Either need jgloc or P_loc, but I have neither -- how did Yadav get jgloc for his IATE script?</span>
                
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">jgloc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">in </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n\t</span><span class="s2">Read in jgloc: </span><span class="si">{</span><span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="se">\n\t</span><span class="s2">Invalid type for jgloc&quot;</span><span class="p">)</span>

<span class="w">                </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                8 cond x 7 port?</span>

<span class="sd">                % exp_z = [0.38, 1.75, 3.12, 3.59, 4.96, 8.16, 12.58];</span>

<span class="sd">                titles=[&#39;Run1: j_{g}=0.039 [m/s] &amp; j_{f}=0.018 [m/s]&#39;; &#39;Run2: j_{g}=0.039 [m/s] &amp; j_{f}=0.682 [m/s]&#39;...</span>
<span class="sd">                    ;&#39;Run3: j_{g}=0.136 [m/s] &amp; j_{f}=0.682 [m/s]&#39;;&#39;Run4: j_{g}=0.138 [m/s] &amp; j_{f}=2.336 [m/s]&#39;;...</span>
<span class="sd">                    &#39;Run5: j_{g}=0.538 [m/s] &amp; j_{f}=5.100 [m/s]&#39;;&#39;Run6: j_{g}=1.234 [m/s] &amp; j_{f}=5.100 [m/s]&#39;;...</span>
<span class="sd">                    &#39;Run7: j_{g}=0.039 [m/s] &amp; j_{f}=0.064 [m/s]&#39;;&#39;Run8: j_{g}=0.039 [m/s] &amp; j_{f}=0.020 [m/s]&#39;];</span>

<span class="sd">                jg_exp = [</span>
<span class="sd">                    0.083	0.090	0.099	0.101	0.102	0.104	0.106</span>
<span class="sd">                    0.136	0.148	0.163	0.166	0.168	0.171	0.175	</span>
<span class="sd">                    0.200	0.217	0.237	0.241	0.244	0.248	0.254	</span>
<span class="sd">                    0.072	0.078	0.085	0.087	0.089	0.091	0.095	</span>
<span class="sd">                    0.118	0.128	0.140	0.143	0.145	0.149	0.156	</span>
<span class="sd">                    0.177	0.191	0.207	0.212	0.216	0.222	0.232</span>
<span class="sd">                    0.094	0.101	0.108	0.110	0.113	0.123	0.139</span>
<span class="sd">                    0.141	0.148	0.159	0.162	0.167	0.182	0.206</span>
<span class="sd">                    ]</span>
<span class="sd">                </span>
<span class="sd">                p_exp = [</span>
<span class="sd">                    65707       51705.5     37799.6     34874.5     33378.4     31206.5     28138.4</span>
<span class="sd">                    68051       54277.2     40722.9     37763.4     36191.4     34100.3     30710.1</span>
<span class="sd">                    72326       58793.3     45604.4     42651.8     40976.4     38958.3     35329.6</span>
<span class="sd">                    94527       79201.8     64227.2     60578.2     57737.5     53657.9     46885.2</span>
<span class="sd">                    97147       81952.8     67116.1     63577.4     60495.5     56277.9     49353.5</span>
<span class="sd">                    100801      85731.1     71121.9     67438.5     64391.0     59910.8     52876.7</span>
<span class="sd">                    148848      132598.1    115749.7	111996.5	106153.9	89964.0     68377.4</span>
<span class="sd">                    153108      136853.6    120051.4	116366.2	110189.3	92801.6     69618.0</span>
<span class="sd">                    ];</span>
<span class="sd">                &#39;&#39;&#39;</span>

                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">sheet_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">jgatm</span> <span class="o">=</span> <span class="n">jgatm</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;J328&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_ai_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;K328&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q1_ranges</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_check</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column </span><span class="si">{</span><span class="n">Q1_start</span><span class="si">}</span><span class="s1"> could not be floatified. Skipping...&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_end</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                            
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>

            <span class="c1">############################################################################################################################</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">#                                                        PITA DATA                                                         #</span>
            <span class="c1">#                                                                                                                          #</span>
            <span class="c1">############################################################################################################################</span>
            <span class="c1"># General PITA template structure holds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;infer&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsm&#39;</span> <span class="ow">or</span> <span class="s1">&#39;adix&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">sheet_type</span> <span class="o">=</span> <span class="s1">&#39;adix_template4&#39;</span>
                    <span class="k">elif</span> <span class="s1">&#39;60deg&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;30deg&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;80deg&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;Ryan&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;ryan&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">sheet_type</span> <span class="o">=</span> <span class="s1">&#39;ryan_template&#39;</span>
                    <span class="k">elif</span> <span class="s1">&#39;P4&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;P5&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;P6&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;P7&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;Quan&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;quan&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                        <span class="n">sheet_type</span> <span class="o">=</span> <span class="s1">&#39;adix_template&#39;</span> <span class="c1"># Might rename this Quan template</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sheet_type</span> <span class="o">=</span> <span class="s1">&#39;adix_template&#39;</span>

                <span class="k">if</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;ryan_template&#39;</span><span class="p">:</span>
                    <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">33</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">82</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">108</span><span class="p">,</span> <span class="mi">133</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">182</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">208</span><span class="p">,</span> <span class="mi">233</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">82</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">108</span><span class="p">,</span> <span class="mi">133</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">182</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_start</span> <span class="o">=</span> <span class="s1">&#39;CP&#39;</span>
                    <span class="n">Q2_end</span> <span class="o">=</span> <span class="s1">&#39;ES&#39;</span>
                    <span class="n">Q1_start</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
                    <span class="n">Q1_end</span> <span class="o">=</span> <span class="s1">&#39;BD&#39;</span>

                    <span class="n">Q1_check</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
                    <span class="n">Q2_check</span> <span class="o">=</span> <span class="s1">&#39;DA&#39;</span>
                
                <span class="k">elif</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;adix_template&#39;</span><span class="p">:</span>
                    <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">29</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">74</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">121</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">145</span><span class="p">,</span> <span class="mi">166</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="mi">213</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">74</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">121</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">145</span><span class="p">,</span> <span class="mi">166</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_start</span> <span class="o">=</span> <span class="s1">&#39;CP&#39;</span>
                    <span class="n">Q2_end</span> <span class="o">=</span> <span class="s1">&#39;ES&#39;</span>
                    <span class="n">Q1_start</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
                    <span class="n">Q1_end</span> <span class="o">=</span> <span class="s1">&#39;BD&#39;</span>

                    <span class="n">Q1_check</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
                    <span class="n">Q2_check</span> <span class="o">=</span> <span class="s1">&#39;DA&#39;</span>
                
                <span class="k">elif</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;adix_template4&#39;</span><span class="p">:</span>
                    <span class="n">pitot_sheet</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">29</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">74</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">121</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">145</span><span class="p">,</span> <span class="mi">166</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="mi">213</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">74</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">121</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">145</span><span class="p">,</span> <span class="mi">166</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_start</span> <span class="o">=</span> <span class="s1">&#39;CR&#39;</span>
                    <span class="n">Q2_end</span> <span class="o">=</span> <span class="s1">&#39;ET&#39;</span>
                    <span class="n">Q1_start</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
                    <span class="n">Q1_end</span> <span class="o">=</span> <span class="s1">&#39;BD&#39;</span>
                    <span class="n">Q1_pitot_start</span> <span class="o">=</span> <span class="s1">&#39;CF&#39;</span>
                    <span class="n">Q1_pitot_end</span> <span class="o">=</span> <span class="s1">&#39;CO&#39;</span>
                    <span class="n">Q2_pitot_start</span> <span class="o">=</span> <span class="s1">&#39;FV&#39;</span>
                    <span class="n">Q2_pitot_end</span> <span class="o">=</span> <span class="s1">&#39;GE&#39;</span>

                    <span class="n">Q1_check</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
                    <span class="n">Q2_check</span> <span class="o">=</span> <span class="s1">&#39;DA&#39;</span>
                    <span class="n">Q1_pitot_check</span> <span class="o">=</span> <span class="s1">&#39;CJ&#39;</span>
                    <span class="n">Q2_pitot_check</span> <span class="o">=</span> <span class="s1">&#39;FZ&#39;</span>
                
                <span class="k">elif</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;neup_template&#39;</span><span class="p">:</span>
                    <span class="n">pitot_sheet</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">31</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">78</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">104</span><span class="p">,</span> <span class="mi">127</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">174</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">223</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">78</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">104</span><span class="p">,</span> <span class="mi">127</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">174</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_start</span> <span class="o">=</span> <span class="s1">&#39;CR&#39;</span>
                    <span class="n">Q2_end</span> <span class="o">=</span> <span class="s1">&#39;ET&#39;</span>
                    <span class="n">Q1_start</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
                    <span class="n">Q1_end</span> <span class="o">=</span> <span class="s1">&#39;BD&#39;</span>
                    <span class="n">Q1_pitot_start</span> <span class="o">=</span> <span class="s1">&#39;CF&#39;</span>
                    <span class="n">Q1_pitot_end</span> <span class="o">=</span> <span class="s1">&#39;CO&#39;</span>
                    <span class="n">Q2_pitot_start</span> <span class="o">=</span> <span class="s1">&#39;FV&#39;</span>
                    <span class="n">Q2_pitot_end</span> <span class="o">=</span> <span class="s1">&#39;GE&#39;</span>

                    <span class="n">Q1_check</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
                    <span class="n">Q2_check</span> <span class="o">=</span> <span class="s1">&#39;DA&#39;</span>
                    <span class="n">Q1_pitot_check</span> <span class="o">=</span> <span class="s1">&#39;CJ&#39;</span>
                    <span class="n">Q2_pitot_check</span> <span class="o">=</span> <span class="s1">&#39;FZ&#39;</span>

                <span class="k">elif</span> <span class="n">sheet_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;neup_template1&#39;</span><span class="p">:</span>
                    <span class="n">pitot_sheet</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">31</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">78</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">104</span><span class="p">,</span> <span class="mi">127</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">174</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">223</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mf">112.5</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mf">157.5</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">78</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">104</span><span class="p">,</span> <span class="mi">127</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">174</span><span class="p">)]</span> <span class="p">]))</span>
                    <span class="n">Q2_start</span> <span class="o">=</span> <span class="s1">&#39;CR&#39;</span>
                    <span class="n">Q2_end</span> <span class="o">=</span> <span class="s1">&#39;ET&#39;</span>
                    <span class="n">Q1_start</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
                    <span class="n">Q1_end</span> <span class="o">=</span> <span class="s1">&#39;BD&#39;</span>
                    <span class="n">Q1_pitot_start</span> <span class="o">=</span> <span class="s1">&#39;CF&#39;</span>
                    <span class="n">Q1_pitot_end</span> <span class="o">=</span> <span class="s1">&#39;CO&#39;</span>
                    <span class="n">Q2_pitot_start</span> <span class="o">=</span> <span class="s1">&#39;FV&#39;</span>
                    <span class="n">Q2_pitot_end</span> <span class="o">=</span> <span class="s1">&#39;GE&#39;</span>

                    <span class="n">Q1_check</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
                    <span class="n">Q2_check</span> <span class="o">=</span> <span class="s1">&#39;DA&#39;</span>
                    <span class="n">Q1_pitot_check</span> <span class="o">=</span> <span class="s1">&#39;CJ&#39;</span>
                    <span class="n">Q2_pitot_check</span> <span class="o">=</span> <span class="s1">&#39;FZ&#39;</span>


                <span class="k">elif</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span> <span class="ow">or</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;Custom&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hopefully you specified all the ranges, starts, ends, and checks&#39;</span><span class="p">)</span>
                
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Unknown sheet type&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
                
                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
                
                <span class="n">jglocs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;O16&#39;</span><span class="p">,</span> <span class="s1">&#39;O17&#39;</span><span class="p">,</span> <span class="s1">&#39;O18&#39;</span><span class="p">,</span> <span class="s1">&#39;O19&#39;</span><span class="p">,</span> <span class="s1">&#39;O20&#39;</span><span class="p">,</span> <span class="s1">&#39;O21&#39;</span><span class="p">,</span> <span class="s1">&#39;O22&#39;</span><span class="p">,</span> <span class="s1">&#39;O23&#39;</span><span class="p">,</span> <span class="s1">&#39;O24&#39;</span><span class="p">,</span> <span class="s1">&#39;O25&#39;</span><span class="p">]</span> <span class="c1"># Experimental Port 1,2,3,4,5A,5C,5B,6A,6,7 --&gt; Now Port 1,2,3,4,5,6,7,8,9,10. Quan 10/28</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="n">jglocs</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="n">port</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">value</span>
                    <span class="c1">#jgloc = ws[jglocs[int(port.strip(&#39;P&#39;))]].value</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not identify port # for </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">, setting jgloc = jgref&quot;</span><span class="p">)</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">jgref</span>

                <span class="c1"># Above jglocs not implemented for Ryan templates (DHK)</span>
                <span class="k">if</span> <span class="n">jgloc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;ryan_template&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sheet type identified as </span><span class="si">{</span><span class="n">sheet_type</span><span class="si">}</span><span class="s2">, referencing cell U23 for jgloc&quot;</span><span class="p">)</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;U23&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                <span class="k">elif</span> <span class="n">jgloc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: jgloc could not be found, setting jgloc = jgref&quot;</span><span class="p">)</span>
                    <span class="n">jgloc</span> <span class="o">=</span> <span class="n">jgref</span>
                <span class="c1"># print(theta)</span>
                <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">sheet_type</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                    <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>

                <span class="n">cond</span><span class="o">.</span><span class="n">run_ID</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

                <span class="c1"># Local corrected gauge pressure can also be back-calculated from jgloc and jgatm (DHK)</span>
                <span class="c1"># cond.jgatm = ws[&#39;D6&#39;].value  # Recorded experimental jgatm when data was taken, might vary slightly on different days or at different ports due to different temp or other BCs</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">jgatm</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;D7&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>   <span class="c1"># Quan 10/25 U-bend data, fixed jgatm for all the ports to avoid cofusion in later modeling </span>

                <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>
                
                <span class="k">if</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;ryan_template&#39;</span><span class="p">:</span>
                    <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;G266&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_ai_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;J266&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    
                <span class="k">elif</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;adix_template&#39;</span> <span class="ow">or</span> <span class="n">sheet_type</span> <span class="o">==</span> <span class="s1">&#39;adix_template4&#39;</span><span class="p">:</span>
                    <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;G246&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                    <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_ai_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;J246&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
                
                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q1_ranges</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_check</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column </span><span class="si">{</span><span class="n">Q1_start</span><span class="si">}</span><span class="s1"> could not be floatified. Skipping...&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_end</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                            
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>

                
                <span class="k">if</span> <span class="n">pitot_sheet</span><span class="p">:</span> <span class="c1"># Pitot data for Q1</span>
                    <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q1_ranges</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_pitot_check</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="ow">and</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_check</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_pitot_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                                <span class="k">except</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column </span><span class="si">{</span><span class="n">Q1_start</span><span class="si">}</span><span class="s1"> could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                                    <span class="k">continue</span>

                                <span class="n">pitot_output</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_pitot_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q1_pitot_end</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                    <span class="n">pitot_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pitot_keys2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">pitot_output</span> <span class="p">):</span>
                                    <span class="n">pitot_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">pitot_keys2</span><span class="p">,</span> <span class="n">pitot_output</span> <span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, pitot_keys2 not the same length as pitot_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="n">pitot_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">pitot_keys2</span><span class="p">,</span> <span class="n">pitot_output</span> <span class="p">))</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pitot_keys2 not the same length as pitot_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">pitot_keys2</span><span class="p">,</span> <span class="n">pitot_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">][</span><span class="n">roverR</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pitot_data</span><span class="p">)</span>
                                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                    <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span>
                                    <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">][</span><span class="n">roverR</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pitot_data</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q2_ranges</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_check</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column </span><span class="si">{</span><span class="n">Q2_start</span><span class="si">}</span><span class="s1"> could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                                <span class="k">continue</span>
                            
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_end</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                            
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, tab_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                                <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                                <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span> 

                <span class="k">if</span> <span class="n">pitot_sheet</span><span class="p">:</span> <span class="c1"># Pitot data for Q2</span>
                    <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q2_ranges</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_pitot_check</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_pitot_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                                <span class="k">except</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column </span><span class="si">{</span><span class="n">Q2_pitot_start</span><span class="si">}</span><span class="s1"> could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                                    <span class="k">continue</span>

                                <span class="n">pitot_output</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_pitot_start</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Q2_pitot_end</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                                    <span class="n">pitot_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pitot_keys2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">pitot_output</span> <span class="p">):</span>
                                    <span class="n">pitot_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">pitot_keys2</span><span class="p">,</span> <span class="n">pitot_output</span> <span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, pitot_keys2 not the same length as pitot_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="n">pitot_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">pitot_keys2</span><span class="p">,</span> <span class="n">pitot_output</span> <span class="p">))</span>
                                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pitot_keys2 not the same length as pitot_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                        <span class="nb">print</span><span class="p">(</span><span class="n">pitot_keys2</span><span class="p">,</span> <span class="n">pitot_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">][</span><span class="n">roverR</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pitot_data</span><span class="p">)</span>
                                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                    <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span>
                                    <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">][</span><span class="n">roverR</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pitot_data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">debug</span> <span class="ow">and</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
            <span class="n">cond</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">append_to_json</span><span class="p">:</span>
        <span class="c1"># Read in previous data, and append this new data to that</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">append_to_json</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span> <span class="c1"># pickle works with binary data, hence rb</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        
        <span class="n">all_conditions</span> <span class="o">=</span> <span class="n">data</span> <span class="o">+</span> <span class="n">all_conditions</span> <span class="c1"># In theory could produce a database with heterogeneous Condition objects, if messing with source code</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dump_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">all_conditions</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">return</span></div>



<div class="viewcode-block" id="dump_data_from_tabs">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.dump_data_from_tabs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">dump_data_from_tabs</span><span class="p">(</span><span class="n">dump_file</span> <span class="o">=</span> <span class="s1">&#39;PITA_Database.dat&#39;</span><span class="p">,</span> <span class="n">skip_dir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">all_conditions</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
        

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
                    
                    <span class="c1">#print(path)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf&#39;</span><span class="p">))</span>
                        <span class="n">jg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg&#39;</span><span class="p">))</span>
                        <span class="n">port</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
                        <span class="n">phi_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

                        <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jg</span><span class="p">,</span> <span class="n">jg</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                            <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                                                
                        <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>

                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                            <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="p">]</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1">#print(&quot;Warning, tab_keys not the same length as midas_output&quot;)</span>
                                <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tab_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                        <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">midas_output</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="s1">&#39;i&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="o">-</span><span class="n">roverR</span>
                        <span class="c1">#print(roverR)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi_val</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi_val</span><span class="p">:{}}</span> <span class="p">)</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi_val</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                            <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi_val</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>                    
                        

                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Continuing...&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

            

    <span class="k">if</span> <span class="n">debug</span> <span class="ow">and</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Printing all things read from files&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
            <span class="n">cond</span><span class="p">:</span><span class="n">Condition</span>
            <span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
                <span class="n">cond</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
            
                    
    
    <span class="c1"># print(&quot;Found the following conditions:&quot;)</span>
    <span class="c1"># for cond in all_conditions:</span>
    <span class="c1">#     print(cond)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dump_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">all_conditions</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="k">return</span></div>


<div class="viewcode-block" id="loadData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.loadData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">loadData</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span> <span class="c1"># pickle works with binary data, hence rb</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="loadProbeData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.loadProbeData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">loadProbeData</span><span class="p">(</span><span class="n">data_file</span> <span class="o">=</span> <span class="s1">&#39;PITA_Database.dat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span> <span class="c1"># pickle works with binary data, hence rb</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="dumpData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.dumpData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">dumpData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dump_file</span> <span class="o">=</span> <span class="s2">&quot;database.dat&quot;</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dump_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="extractPitotData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.extractPitotData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extractPitotData</span><span class="p">(</span><span class="n">dump_file</span> <span class="o">=</span> <span class="s1">&#39;Pitot_Database.dat&#39;</span><span class="p">,</span> <span class="n">in_dir</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">require_terms</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">skip_terms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CFD&#39;</span><span class="p">,</span> <span class="s1">&#39;Copy&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">Q1_ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">33</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">82</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">108</span><span class="p">,</span> <span class="mi">133</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">182</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">208</span><span class="p">,</span> <span class="mi">233</span><span class="p">)]</span> <span class="p">]))</span>

    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;Z:</span><span class="se">\\</span><span class="s2">TRSL</span><span class="se">\\</span><span class="s2">PITA</span><span class="se">\\</span><span class="s2">Data</span><span class="se">\\</span><span class="s2">PitotData&quot;</span>

    <span class="n">all_conditions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
            
            <span class="c1"># Check if the file has any skipped/required terms</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">skip_terms</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">require_terms</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="k">continue</span>
            
            <span class="c1">#if debug: print(path, file=debugFID)</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">data_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading wb: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">Skipping...&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf&#39;</span><span class="p">))</span>
                <span class="n">jgref</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg&#39;</span><span class="p">))</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">)</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;deg&#39;</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: Non-standard excel file name </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">. Skipping...&#39;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
            <span class="n">jgloc</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;U23&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

            <span class="n">newCond</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="n">jgref</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">,</span> <span class="n">jf</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="s1">&#39;Pitot&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">newCond</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_conditions</span><span class="p">:</span>
                <span class="n">all_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span>
                <span class="n">cond</span> <span class="o">=</span> <span class="n">newCond</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cond</span> <span class="o">=</span> <span class="n">all_conditions</span><span class="p">[</span> <span class="n">all_conditions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">newCond</span><span class="p">)</span> <span class="p">]</span>
            
            <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">]</span>

            <span class="n">cond</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;G266&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            
            <span class="k">for</span> <span class="n">phi</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">Q1_ranges</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;E</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">roverR</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;A</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: data found in row </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> in sheet </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">, but column A could not be floatified. Skipping...&#39;</span><span class="p">)</span>
                            <span class="k">continue</span>
                        
                        <span class="n">midas_output</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;B</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;BD</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="n">midas_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                        
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span> <span class="n">midas_output</span> <span class="p">):</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">pitot_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, pitot_keys not the same length as midas_output&quot;</span><span class="p">)</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">pitot_keys</span><span class="p">,</span> <span class="n">midas_output</span> <span class="p">))</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pitot_keys not the same length as midas_output&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">pitot_keys</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">phi</span><span class="p">:{}}</span> <span class="p">)</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">})</span>
                            <span class="c1">#cond.phi[phi_val].update({0.0: zero_data}) # Cuz I&#39;m paranoid</span>
                            <span class="n">cond</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">phi</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">roverR</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>


    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dump_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
        <span class="c1">#print(all_conditions)</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">all_conditions</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="loadPitotData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.loadPitotData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">loadPitotData</span><span class="p">(</span><span class="n">data_file</span> <span class="o">=</span> <span class="s1">&#39;Pitot_Database.dat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span> <span class="c1"># pickle works with binary data, hence rb</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="extractIskandraniData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.extractIskandraniData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extractIskandraniData</span><span class="p">(</span><span class="n">dump_file</span><span class="o">=</span><span class="s1">&#39;Iskandrani_Database.dat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="s2">&quot;Z:</span><span class="se">\\</span><span class="s2">TRSL</span><span class="se">\\</span><span class="s2">PITA\Data</span><span class="se">\\</span><span class="s2">LocalData</span><span class="se">\\</span><span class="s2">Iskandrani</span><span class="se">\\</span><span class="s2">Iskandrani_Local_Velocity.xlsx&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The path to the Iskandrani data is hardcoded, maybe the file moved?&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">database</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="n">wb</span><span class="o">.</span><span class="n">worksheets</span><span class="p">:</span>
        <span class="c1">#print(ws)</span>
        <span class="n">jf</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">jg</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">new_cond</span> <span class="o">=</span> <span class="n">Iskandrani_Condition</span><span class="p">(</span><span class="n">jf</span><span class="p">,</span> <span class="n">jg</span><span class="p">)</span>

        <span class="n">new_cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;rs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A4:A24&#39;</span><span class="p">]]})</span>
        <span class="n">new_cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B4:B24&#39;</span><span class="p">]]})</span>
        <span class="n">new_cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;D4:D24&#39;</span><span class="p">]]})</span>
        <span class="n">new_cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vfp&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;C4:C24&#39;</span><span class="p">]]})</span>
        <span class="n">new_cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;bubble_freq&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;E4:E24&#39;</span><span class="p">]]})</span>
        <span class="n">new_cond</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;fluctuations&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;F4:F24&#39;</span><span class="p">]]})</span>

        <span class="n">database</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_cond</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dump_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="k">return</span></div>


<div class="viewcode-block" id="loadIskandraniData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.loadIskandraniData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">loadIskandraniData</span><span class="p">(</span><span class="n">data_file</span> <span class="o">=</span> <span class="s1">&#39;Iskandrani_Database.dat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span> <span class="c1"># pickle works with binary data, hence rb</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="extractYangData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.extractYangData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">extractYangData</span><span class="p">(</span><span class="n">dump_file</span><span class="o">=</span><span class="s1">&#39;Yang_Database.dat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">wb</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="s2">&quot;Z:</span><span class="se">\\</span><span class="s2">TRSL</span><span class="se">\\</span><span class="s2">PITA\Data</span><span class="se">\\</span><span class="s2">LocalData</span><span class="se">\\</span><span class="s2">Yang_et_al_mean_velocity_profiles.xlsx&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The path to the Yang data is hardcoded, maybe the file moved?&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    
    <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

    <span class="n">database</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">header_cell</span> <span class="ow">in</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]:</span>

        <span class="k">if</span> <span class="n">header_cell</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">jf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">header_cell</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jf=&#39;</span><span class="p">))</span>
            <span class="n">jg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">header_cell</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;jg=&#39;</span><span class="p">))</span>
            <span class="n">phi_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header_cell</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">database</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">jf</span> <span class="o">!=</span> <span class="n">jf</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">jg</span> <span class="o">!=</span> <span class="n">jg</span><span class="p">):</span>
                    <span class="n">database</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Yang_Condition</span><span class="p">(</span><span class="n">jf</span><span class="p">,</span> <span class="n">jg</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">database</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Yang_Condition</span><span class="p">(</span><span class="n">jf</span><span class="p">,</span> <span class="n">jg</span><span class="p">)</span> <span class="p">)</span>

            <span class="n">r_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">zero_data</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">):</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="n">header_cell</span><span class="o">.</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                <span class="n">vf</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="n">header_cell</span><span class="o">.</span><span class="n">column</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                <span class="n">midas_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vf&#39;</span><span class="p">:</span> <span class="n">vf</span><span class="p">}</span>
                <span class="n">r_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">r</span><span class="p">:</span> <span class="n">midas_dict</span><span class="p">})</span>
            <span class="n">database</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">phi_value</span><span class="p">:</span> <span class="n">r_dict</span><span class="p">})</span>      

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dump_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="k">return</span></div>


<div class="viewcode-block" id="loadYangData">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.extracts_and_loads.loadYangData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">loadYangData</span><span class="p">(</span><span class="n">data_file</span> <span class="o">=</span> <span class="s1">&#39;Yang_Database.dat&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span> <span class="c1"># pickle works with binary data, hence rb</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span></div>


<span class="n">tab_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;signed_roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;frequency&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_G1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_G2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_total&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bub_freq&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;percent_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_G1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_G2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_G1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_G2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Lcl1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Lcl2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fluctuation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_ug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_Dsm1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_Dsm2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r02&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r03&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r12&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r13&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r23&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;jf_loc&#39;</span>
<span class="p">]</span>

<span class="n">old_tab_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_total&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bub_freq&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;percent_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fluctuation_ug&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">zero_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)))</span>

<span class="n">pitot_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;frequency&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delta_p&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_delta_p&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vf&#39;</span><span class="p">]</span>

<span class="n">pitot_keys2</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;signed_roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;frequency&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delta_p&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_delta_p&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vf_naive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;jf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vr&#39;</span>
<span class="p">]</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">MARIGOLD</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Example Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MARIGOLD.html">MARIGOLD Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div> 
    <div class="footer">
      &#169;2024, adix.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #daaa00;
    }
    /* Sidebar */
    .wy-body-for-nav, .wy-nav-side, .wy-grid-for-nav, .wy-nav-shift {
        background: #555960;
    }
    .wy-nav-content {
        background: #c4bfc0;
    }
  </style>

  </body>
</html>