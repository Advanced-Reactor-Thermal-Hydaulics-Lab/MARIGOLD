<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MARIGOLD.Condition &mdash; MARIGOLD 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MARIGOLD
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../MARIGOLD.html">MARIGOLD</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MARIGOLD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">MARIGOLD.Condition</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for MARIGOLD.Condition</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">.config</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<div class="viewcode-block" id="Condition">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition">[docs]</a>
<span class="k">class</span> <span class="nc">Condition</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Class to handle the local probe data</span>

<span class="sd">    Data is stored in the Condition.phi property. It&#39;s actually 3 layers of dictionary</span>
<span class="sd">    phi [angle] gives a dictionary with the various r/R</span>
<span class="sd">    phi [angle][r/R] gives a dictionary with the MIDAS output</span>
<span class="sd">    The MIDAS output is itself a dictionary, with the keys listed in the &quot;tab_keys&quot; array</span>
<span class="sd">    So phi[angle][r/R][&#39;alpha&#39;] should give you the void fraction at r/R for phi = angle</span>
<span class="sd">    This structure is initialized with zeros for the MIDAS output at the pipe center and wall</span>

<span class="sd">    Can also get the data at a local point from calling the condition, syntax</span>

<span class="sd">    cond(phi, r, &#39;param&#39;). Phi is in radians, the arguments can be constants or numpy arrays.</span>
<span class="sd">    Also has an option for interpolation, &#39;interp_method&#39;</span>

<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">debugFID</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jgref</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">jgloc</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">jf</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">fluids</span> <span class="o">=</span> <span class="s1">&#39;air-water&#39;</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initialize Condition object</span>

<span class="sd">        Inputs:</span>
<span class="sd">        - jgref, reference superficial gas velocity</span>
<span class="sd">        - jgloc, local superficial gas velocity</span>
<span class="sd">        - jf, superficial liquid velocity</span>
<span class="sd">        - theta, angle of inclination of flow direction (0° is horizontal, 90° is vertical upwards)</span>
<span class="sd">        - port, string to denote the port</span>
<span class="sd">        - database, string to associate what database this data is from</span>

<span class="sd">        Optional inputs:</span>
<span class="sd">        - fluids, what fluid pair to use as the gas and liquid</span>
<span class="sd">        - g, gravitational acceleration. In case you&#39;re on Mars</span>

<span class="sd">        Implemented Fluids:</span>
<span class="sd">        - air-water, uses properties at atmospheric conditions</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jgref</span> <span class="o">=</span> <span class="n">jgref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">=</span> <span class="n">jf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">=</span><span class="n">jgloc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;jf=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jf</span><span class="si">}</span><span class="s2">_jgloc=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">_theta=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="si">}</span><span class="s2">_port=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Data is stored in this phi array. 3 layers of dictionary</span>
        <span class="c1"># phi [angle] gives a dictionary with the various r/R</span>
        <span class="c1"># phi [angle][r/R] gives a dictionary with the MIDAS output</span>
        <span class="c1"># So phi[angle][r/R][&#39;alpha&#39;] should give you the void fraction at r/R for phi = angle</span>
        <span class="c1"># This structure is initialized with zeros for the MIDAS output at the pipe center and wall</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">)</span> <span class="c1"># HARDCODED 22.5 degree increments</span>
        <span class="c1">#self.phi = deepcopy(dict( zip(angles, deepcopy([ {0.0: dict( zip(tab_keys, [0]*len(tab_keys)) ), 1.0: dict(zip(tab_keys, [0]*len(tab_keys)) ) } ]) * len(angles)) ))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirrored</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Flow regime variable. 0 is undefined, 1 is bubbly, etc.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span>

        <span class="k">if</span> <span class="s1">&#39;D&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="ow">and</span> <span class="s1">&#39;P&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># Assume it&#39;s PITA</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">30</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P2&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">66</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P3&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">110</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P4&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">130</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P5A&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">146</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P5B&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">154</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P6&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">190</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="s1">&#39;P7&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="mi">226</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LoverD</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not determine port L/D for </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vwvg</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">void_cov</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">area_avg_void_sheet</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;Ryan&#39;</span> <span class="ow">or</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;ryan&#39;</span> <span class="ow">or</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;adix&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">=</span> <span class="mf">0.0254</span> <span class="c1"># m, for Ryan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_style</span> <span class="o">=</span> <span class="s1">&#39;solid&#39;</span>

        <span class="k">elif</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;Kong&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">=</span> <span class="mf">0.1016</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_style</span> <span class="o">=</span> <span class="s1">&#39;dotted&#39;</span>

        <span class="k">elif</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;Talley&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">=</span> <span class="mf">0.0381</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">=</span> <span class="s1">&#39;^&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_color</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_style</span> <span class="o">=</span> <span class="s1">&#39;dashed&#39;</span>

        <span class="k">elif</span> <span class="n">database</span> <span class="o">==</span> <span class="s1">&#39;Yadav&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">=</span> <span class="mf">0.0508</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line_style</span> <span class="o">=</span> <span class="s1">&#39;dashdot&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not determine Dh for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">=</span> <span class="s1">&#39;$?$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marker_color</span> <span class="o">=</span> <span class="s1">&#39;yellow&#39;</span>

        <span class="c1"># Empty dictionaries, filled when max or area avg is called</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area_avgs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circ_seg_area_avgs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mins</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grads_calced</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">fluids</span> <span class="o">==</span> <span class="s1">&#39;air-water&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">=</span> <span class="mi">998</span>       <span class="c1"># kg/m^3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rho_g</span> <span class="o">=</span> <span class="mf">1.204</span>     <span class="c1"># kg/m^3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mu_f</span> <span class="o">=</span> <span class="mf">0.001002</span>   <span class="c1"># Pa s</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mu_g</span> <span class="o">=</span> <span class="mf">0.01803e-3</span> <span class="c1"># Pa s</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.0728</span>    <span class="c1"># N/m</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fluids</span><span class="si">}</span><span class="s2"> not available, try &#39;air-water&#39;&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">g</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__o</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">__o</span><span class="p">,</span> <span class="n">Condition</span><span class="p">):</span>

            <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">==</span> <span class="n">__o</span><span class="o">.</span><span class="n">jf</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jgref</span> <span class="o">==</span> <span class="n">__o</span><span class="o">.</span><span class="n">jgref</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="n">__o</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">==</span> <span class="n">__o</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">==</span> <span class="n">__o</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phi_in</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">r_in</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">interp_method</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Returns the value of param at (phi, r). Phi is in radians</span>
<span class="sd">         </span>
<span class="sd">        Interp options:</span>
<span class="sd">         - &#39;None&#39;, will try to fetch raw data at this location</span>
<span class="sd">         - &#39;linear&#39;, linear interpolation</span>
<span class="sd">         - &#39;spline&#39;, spline interpolation</span>
<span class="sd">         - &#39;linear_xy&#39;, cartesian interpolation, phi -&gt; x, r -&gt; y</span>
<span class="sd">           </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">phi_in</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Converting phi_in to np.ndarray&quot;</span><span class="p">)</span>
            <span class="n">phi_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phi_in</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">r_in</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Converting r_in to np.ndarray&quot;</span><span class="p">)</span>
            <span class="n">r_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">r_in</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="n">interp_method</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">param_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">r_in</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">phi_in</span><span class="o">.</span><span class="n">size</span><span class="p">))</span> <span class="c1"># TODO check if r_in and phi_in actually exist</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r_in</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">phi_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">phi_in</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">phi_val</span><span class="p">)</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="p">)][</span><span class="n">r_val</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
                        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">r_val</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
                                <span class="n">param_values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                                <span class="k">raise</span> 
            <span class="k">except</span><span class="p">:</span>
                <span class="c1"># Probably input a single phi instead of an array</span>
                <span class="n">param_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">phi_in</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="p">)][</span><span class="n">r_in</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">param_values</span>
        
        <span class="k">elif</span> <span class="n">interp_method</span> <span class="o">==</span> <span class="s1">&#39;spline&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">(</span><span class="n">phi_in</span><span class="p">,</span> <span class="n">r_in</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">(</span><span class="n">uniform_rmesh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fit_spline</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phi_in</span><span class="p">,</span> <span class="n">r_in</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">interp_method</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phi_in</span><span class="p">,</span> <span class="n">r_in</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_linear_interp</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phi_in</span><span class="p">,</span> <span class="n">r_in</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="n">interp_method</span> <span class="o">==</span> <span class="s1">&#39;linear_xy&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">phi_in</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">r_in</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_xy_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_linear_xy_interp</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_xy_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interp_method</span><span class="si">}</span><span class="s2"> not regonized. Accepted arguments are &#39;None&#39;, &#39;spline&#39;, &#39;linear&#39; or &#39;linear_xy&#39;&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Condition.pretty_print">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.pretty_print">[docs]</a>
    <span class="k">def</span> <span class="nf">pretty_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_to_file</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">FID</span><span class="o">=</span><span class="n">debugFID</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prints out all the information in a Condition in a structured way </span>

<span class="sd">        Specifically, everything in the Condition.phi dictionary, which has angles</span>
<span class="sd">        and r/Rs.</span>

<span class="sd">        Can either print to a file (specified by FID) or to stdout. Option to mirror the </span>
<span class="sd">        data, if that hasn&#39;t already been done</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;jf = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jf</span><span class="si">}</span><span class="se">\t</span><span class="s2">jg = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">jgref</span><span class="si">}</span><span class="se">\t</span><span class="s2">theta = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">FID</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">mirror</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">print_to_file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">FID</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">midas_output</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">FID</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">FID</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">midas_output</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">midas_output</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.mirror">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.mirror">[docs]</a>
    <span class="k">def</span> <span class="nf">mirror</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sym90</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">axisym</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">uniform_rmesh</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">force_remirror</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Mirrors data, so we have data for every angle</span>

<span class="sd">        First finds all the angles with data, copies anything negative to the </span>
<span class="sd">        other side (deleting the negative entries in the original). Then goes</span>
<span class="sd">        though each of the angles in _angles (22.5° increments) and makes sure</span>
<span class="sd">        each has data. Either copying, assuming some kind of symmetry (either</span>
<span class="sd">        axisym or sym90) or just filling in zeros. </span>

<span class="sd">        Axisym = True will find the angle with the most data (i.e. the most r/R</span>
<span class="sd">        locations with data available) and copy it to every other angle in _angles</span>

<span class="sd">        uniform_rmesh will ensure every angle has data for every r/R point. Will</span>
<span class="sd">        linearly interpolate when data on either side is available. This only </span>
<span class="sd">        considers the +r/R mesh</span>
<span class="sd">        </span>
<span class="sd">        Force_remirror is untested, no clue if it&#39;s safe or not</span>
<span class="sd">        </span>
<span class="sd">        Also saves the original mesh (r, φ) pairs under self.original_mesh</span>

<span class="sd">        </span>
<span class="sd">        Quadrant definitions:</span>
<span class="sd">        </span>
<span class="sd">                          phi =  90</span>
<span class="sd">                        , - ~ ~ ~ - ,</span>
<span class="sd">                    , &#39;       |        &#39; ,</span>
<span class="sd">                  ,           |            ,</span>
<span class="sd">                 ,     II     |    I        ,</span>
<span class="sd">                ,             |             ,</span>
<span class="sd">            180 ,-------------|-------------, 0</span>
<span class="sd">                ,             |             ,</span>
<span class="sd">                 ,    III     |   IV       ,</span>
<span class="sd">                  ,           |           ,</span>
<span class="sd">                    ,         |        , &#39;</span>
<span class="sd">                      &#39; - , _ _ _ ,  &#39;</span>
<span class="sd">                             270</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Only ever call this function once</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mirrored</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force_remirror</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="c1"># Have a record of actual measurement locations</span>

        <span class="c1"># First step is to find the phi angles that have data        </span>
        <span class="n">angles_with_data</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_mesh</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rdict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">rdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">midas_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="s1">&#39;num_spherical&#39;</span> <span class="ow">in</span> <span class="n">midas_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;num_spherical&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1894</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;num_cap&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">11</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">):</span>
                            <span class="c1"># this is dummy data, ignore</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;num_spherical&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">302</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ai_distorted&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.25</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">):</span>
                            <span class="c1"># this is dummy data, ignore</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;num_spherical&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">157</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ai_distorted&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.88</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">):</span>
                            <span class="c1"># this is dummy data, ignore</span>
                            <span class="k">continue</span>

                    <span class="n">angles_with_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">original_mesh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">rstar</span><span class="p">)</span> <span class="p">)</span>

        <span class="n">angles_with_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">angles_with_data</span><span class="p">)</span>
        <span class="c1"># print(angles_with_data)</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Angles with data: &#39;</span><span class="p">,</span> <span class="n">angles_with_data</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
        <span class="n">num_angles_measured</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">angles_with_data</span><span class="p">)</span> <span class="c1"># the actual number of angles measured (r/R can be negative)</span>

        <span class="c1"># Next, take any negative values for the existing data and copy them to the </span>
        <span class="c1"># +180 phi angle (the complementary angle)</span>
        <span class="c1"># Also delete the negative data from the existing phi, so all angles only have postive entries</span>
        <span class="n">angles_to_add</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_rs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles_with_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">:</span>
                <span class="n">comp_angle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">+</span> <span class="mi">180</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">comp_angle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">angles_with_data</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">comp_angle</span> <span class="o">&lt;=</span> <span class="mi">360</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">comp_angle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">angles_to_add</span><span class="p">):</span>

                <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">])</span>
                <span class="n">rs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">])</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rs</span><span class="p">:</span>
                    
                    <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">all_rs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    
                    <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">pass</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span> 

                <span class="c1"># There should always be data at r/R 0 so we can plot contours</span>
                <span class="k">try</span><span class="p">:</span> 
                    <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">0.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span>  <span class="c1"># just in case</span>


                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">comp_angle</span><span class="p">:</span> <span class="p">{}})</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)}</span> <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
                

                <span class="n">angles_to_add</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp_angle</span><span class="p">)</span>

        <span class="n">angles_with_data</span> <span class="o">+=</span> <span class="n">angles_to_add</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Angles with data after comp_angle: &#39;</span><span class="p">,</span> <span class="n">angles_with_data</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">360</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">angles_with_data</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="ow">in</span> <span class="n">angles_with_data</span><span class="p">):</span>
            <span class="n">ref_angle</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mi">360</span><span class="p">:</span> <span class="p">{}})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">360</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>
            <span class="n">angles_with_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">360</span><span class="p">)</span>

        <span class="c1"># Now comes the actual mirroring step. Need data for every angle, incremements of 22.5° (self._angles)</span>
        <span class="k">if</span> <span class="n">axisym</span><span class="p">:</span> 
            <span class="c1"># axisymmetric</span>
            <span class="c1"># Find the reference angle with the most data</span>
            <span class="n">ref_angle</span> <span class="o">=</span> <span class="n">angles_with_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># initial guess</span>
            <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">angles_with_data</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">ref_angle</span> <span class="o">=</span> <span class="n">angle</span>
            
            <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">]</span> <span class="p">)</span>
                
                <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">angle</span><span class="p">:</span> <span class="p">{}})</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>

        <span class="k">elif</span> <span class="n">sym90</span><span class="p">:</span> 
            <span class="c1"># symmetric across the 90 degree line</span>
            <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">angle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">angles_with_data</span><span class="p">:</span>

                    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)}</span> <span class="c1"># Fine if this gets overwritten, just need to make sure there&#39;s some data at 0 for plotting</span>

                    <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">:</span>
                        <span class="c1"># Quadrant I, should usually have data here, but if we don&#39;t, try to copy data from Q2</span>
                        <span class="n">ref_angle</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">angle</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data found for </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2"> when mirroring </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, defaulting to 0s&quot;</span><span class="p">)</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)}</span>

                    <span class="k">elif</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">90</span> <span class="ow">and</span> <span class="n">angle</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">:</span>
                       <span class="c1"># Quadrant II, mirror from Quadrant I</span>
                        <span class="n">ref_angle</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">angle</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">])</span>

                    <span class="k">elif</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">180</span> <span class="ow">and</span> <span class="n">angle</span> <span class="o">&lt;=</span> <span class="mi">270</span><span class="p">:</span>
                        <span class="c1"># Quadrant III, should be covered by the negative of Quadrant I</span>
                        <span class="c1"># But if we&#39;re here there&#39;s no data here. So make sure it&#39;s 0</span>
                        <span class="n">ref_angle</span> <span class="o">=</span> <span class="mi">540</span> <span class="o">-</span> <span class="n">angle</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data found for </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2"> when mirroring </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, defaulting to 0s&quot;</span><span class="p">)</span>
                            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)}</span>

                    <span class="k">elif</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">270</span> <span class="ow">and</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">360</span><span class="p">:</span>
                        <span class="c1"># Quadrant IV, mirror from Quadrant III</span>
                        <span class="n">ref_angle</span> <span class="o">=</span> <span class="mi">540</span> <span class="o">-</span> <span class="n">angle</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">])</span>

                    <span class="k">elif</span> <span class="n">angle</span> <span class="o">==</span> <span class="mi">360</span><span class="p">:</span>
                        <span class="n">ref_angle</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">ref_angle</span><span class="p">])</span>

                    <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span> <span class="c1"># paranoia</span>
                    
                    <span class="c1"># Check if data exists at zero, and if not, just put some zero data in</span>
                    <span class="k">try</span><span class="p">:</span> 
                        <span class="n">dummy</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">0.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span> <span class="c1"># just in case</span>
                    
                    <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">360</span><span class="p">:</span> <span class="k">continue</span> <span class="c1"># Just in case</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">angle</span><span class="p">:</span> <span class="p">{}})</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>

            <span class="c1"># Check if data exists at zero, and if not, just put some zero data in</span>
                <span class="k">try</span><span class="p">:</span> 
                    <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">0.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span> <span class="c1"># just in case</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No symmetry being assumed. But we still want data at every angle. If it doesn&#39;t exist, must be 0</span>
            <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">angle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">angles_with_data</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)}</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mf">1.0</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span>
                    <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">360</span><span class="p">:</span> <span class="k">continue</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">angle</span><span class="p">:</span> <span class="p">{}})</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">data</span> <span class="p">)</span>

        <span class="k">if</span> <span class="n">uniform_rmesh</span><span class="p">:</span>
            <span class="c1">#print(all_rs)</span>
            <span class="c1"># Make sure all the angles have data for all the rpoints</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_rs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="c1">#print(self.all_rs)</span>
            <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_rs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># This will break if there&#39;s data for 0.85 in some cases but not others</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">r</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">zero_data</span><span class="p">)})</span>
            
            <span class="c1"># so go through and interpolate the points where we have data on either side</span>
            <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="c1">#print(angle, self.all_rs[i+1])</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]][</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: interpolating data for </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">°, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> to maintain uniform r/R mesh&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">tab_keys</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>

                                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
                                <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="n">x1</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
                                <span class="n">x2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                <span class="n">y2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="n">x2</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>

                                <span class="n">interp</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]][</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">interp</span>
                            
                            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                                <span class="c1">#print(f&quot;{param} not found for {angle}°, {self.all_rs[i+1]}&quot;)</span>
                                <span class="k">continue</span>
                        
                        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;roverR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;interpolated, </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>
                        <span class="c1">#print(f&quot;I&#39;m not interpolating for {angle}°, {self.all_rs[i+1]}&quot;)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">mirrored</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># clean up nones</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">midas_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: &#39;None&#39; value for </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">rstar</span><span class="si">}</span><span class="s2">. Setting to 0&quot;</span><span class="p">)</span>
                        <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">param</span> <span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.approx_vf">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.approx_vf">[docs]</a>
    <span class="k">def</span> <span class="nf">approx_vf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for approximating vf with power-law relation. </span>

<span class="sd">        .. math:: v_{f, approx} = \\frac{(n+1)(2*n+1)}{ (2*n^{2})} * (j_{f} / (1- \\langle \\alpha \\rangle)) * (1 - abs(rstar))**(1/n)</span>

<span class="sd">        Will not overwrite vf data if it already exists, but will always store data in </span>
<span class="sd">        midas_dict[&#39;vf_approx&#39;] even if midas_dict[&#39;vf&#39;] has data</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">vf_approx</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rstar</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">dummy</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;approx_vf: data found for </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">rstar</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vf&#39;</span><span class="p">:</span> <span class="n">vf_approx</span><span class="p">})</span>
                
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vf_approx&#39;</span><span class="p">:</span> <span class="n">vf_approx</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.approx_vg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.approx_vg">[docs]</a>
    <span class="k">def</span> <span class="nf">approx_vg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for approximating vg with power-law relation. I don&#39;t think this makes sense</span>

<span class="sd">        .. math:: v_{g, approx} = \\frac{(n+1)(2*n+1)}{ (2*n^{2})} * (j_{g} / \\langle \\alpha \\rangle) * (1 - abs(rstar))**(1/n)</span>

<span class="sd">        Will not overwrite vg data if it already exists, but will always store data in </span>
<span class="sd">        midas_dict[&#39;vg_approx&#39;] even if midas_dict[&#39;ug1&#39;] has data</span>

<span class="sd">        If you have a lot of group II bubbles this functions&#39; no good</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">vg_approx</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rstar</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">dummy</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;approx_vg: data found for </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">rstar</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;ug1&#39;</span><span class="p">:</span> <span class="n">vg_approx</span><span class="p">})</span>
                
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vg_approx&#39;</span><span class="p">:</span> <span class="n">vg_approx</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.approx_vf_Kong">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.approx_vf_Kong">[docs]</a>
    <span class="k">def</span> <span class="nf">approx_vf_Kong</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for approximating vf from Kong. TODO </span>

<span class="sd">        Not currently implemented</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">vf_approx</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rstar</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vf&#39;</span><span class="p">:</span> <span class="n">vf_approx</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.calc_vf_lee">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_vf_lee">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_vf_lee</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculate vf, jf, vr based on Lee et al. (2002) equation</span>

<span class="sd">        Really a model proposed by Bosio and Malnes</span>

<span class="sd">        .. math:: v_{f} = \\frac{ 1 }{ \\sqrt{1 - \\alpha^{2} / 2} } * \\sqrt{ \\frac{ 2 \\Delta p }{K \\rho_{f}} } </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">dp</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;delta_p&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">6894.757</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Δp needed for cacluclation of vf_lee&quot;</span><span class="p">)</span>
                
                <span class="n">vf_lee</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dp</span> <span class="o">/</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span><span class="p">))</span>
                
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vf_lee&#39;</span><span class="p">:</span> <span class="n">vf_lee</span><span class="p">})</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;jf_lee&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span><span class="o">*</span> <span class="n">vf_lee</span><span class="p">})</span>
                
                <span class="n">vg</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">vg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">vr_lee</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vr_lee</span> <span class="o">=</span> <span class="n">vg</span> <span class="o">-</span> <span class="n">vf_lee</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vr_lee&#39;</span><span class="p">:</span>  <span class="n">vr_lee</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.calc_vf_naive">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_vf_naive">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_vf_naive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculate vf, jf, vr based on single-phase equation</span>

<span class="sd">        .. math::  v_{f} = \\sqrt{ \\frac{ 2 \\Delta p }{ \\rho_{f}} } </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vf_naive</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf_naive&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">dp</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;delta_p&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">6894.757</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Δp needed for cacluclation of vf_naive&quot;</span><span class="p">)</span>
                    
                    <span class="n">vf_naive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="n">dp</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span><span class="p">)</span>
                
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vf_naive&#39;</span><span class="p">:</span> <span class="n">vf_naive</span><span class="p">})</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;jf_naive&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span><span class="o">*</span> <span class="n">vf_naive</span><span class="p">})</span>
                
                <span class="n">vg</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">vg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">vr_naive</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vr_naive</span> <span class="o">=</span> <span class="n">vg</span> <span class="o">-</span> <span class="n">vf_naive</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vr_naive&#39;</span><span class="p">:</span>  <span class="n">vr_naive</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.calc_vr">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_vr">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_vr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">warn_approx</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating relative velocity. Will approximate vf if it cannot be found.</span>

<span class="sd">        Note that if vg = 0, then this method says vr = 0. This will happen when no data is present,</span>
<span class="sd">        such as in the bottom of the pipe in horizontal, when this is not necessarily true</span>

<span class="sd">        warn_approx is a flag to print out a warning statement if vf is being approximated</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vf</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">warn_approx</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Approximating vf in calculating vr, since no data found&quot;</span><span class="p">)</span>
                        <span class="n">warn_approx</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">approx_vf</span><span class="p">()</span>
                    <span class="n">vf</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>
                <span class="n">vg</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">vg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># should be the same as α = 0, could maybe switch this to that</span>
                    <span class="n">vr</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># this is an assumption, similar to void weighting</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vr</span> <span class="o">=</span> <span class="n">vg</span> <span class="o">-</span> <span class="n">vf</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">vr</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.00001</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: vr already present for </span><span class="si">{</span><span class="n">rstar</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">°, but doesn&#39;t match subtraction. Will update and overwrite&quot;</span><span class="p">)</span>
                        <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vr&#39;</span><span class="p">:</span> <span class="n">vr</span><span class="p">})</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vr&#39;</span><span class="p">:</span> <span class="n">vr</span><span class="p">})</span>
                    

        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.calc_vgj">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_vgj">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_vgj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">warn_approx</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating Vgj, by doing</span>

<span class="sd">        j_local = midas_dict[&#39;alpha&#39;] * midas_dict[&#39;ug1&#39;] + (1 - midas_dict[&#39;alpha&#39;]) * midas_dict[&#39;vf&#39;]</span>
<span class="sd">        vgj = midas_dict[&#39;ug1&#39;] - j_local</span>

<span class="sd">        stored in midas_dict[&#39;vgj&#39;]</span>
<span class="sd">        also stores local j, midas_dict[&#39;j&#39;]</span>

<span class="sd">        warn_approx is a flag to print out a warning statement if vf is being approximated, which will</span>
<span class="sd">        happen if not found</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">dummy</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">warn_approx</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Approximating vf in calculating local j, since no data found&quot;</span><span class="p">)</span>
                        <span class="n">warn_approx</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">approx_vf</span><span class="p">()</span>
                
                <span class="n">j_local</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>
                <span class="n">vgj</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">j_local</span>
                <span class="n">alpha_j</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">j_local</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vgj&#39;</span><span class="p">:</span> <span class="n">vgj</span><span class="p">})</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">j_local</span><span class="p">})</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;alpha_j&#39;</span><span class="p">:</span> <span class="n">alpha_j</span><span class="p">})</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.calc_grad">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_grad">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recalc</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates gradient of param based on the data in self. </span>
<span class="sd">        </span>
<span class="sd">        Stored in self&#39;s midas_dict as grad_param_r, grad_param_phi, etc.</span>
<span class="sd">        Will only be called once, unless recalc is True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mirrored</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grads_calced</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">recalc</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grads_calced</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

        <span class="n">grad_param_name</span> <span class="o">=</span> <span class="s1">&#39;grad_&#39;</span> <span class="o">+</span> <span class="n">param</span>

        <span class="n">phis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">phis</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">maxj</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">phis</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">phi_angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">r_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="n">rs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="c1">#print(rs)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span> <span class="p">):</span>
                <span class="k">if</span> <span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> 
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: somehow we still have negative data.</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">phi_angle</span><span class="si">=}</span><span class="se">\t</span><span class="si">{</span><span class="n">rs</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">grad_r_param</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">param</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="n">param</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
                
                <span class="n">j</span> <span class="o">=</span> <span class="n">phis</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">phi_angle</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">maxj</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">hi_phi</span> <span class="o">=</span> <span class="n">phis</span><span class="p">[(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hi_phi</span> <span class="o">=</span> <span class="n">phis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># use 22.5</span>
                
                <span class="n">lo_phi</span> <span class="o">=</span> <span class="n">phis</span><span class="p">[(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span>

                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">lo_phi</span> <span class="o">=</span> <span class="n">phis</span><span class="p">[(</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="p">]</span> <span class="c1"># use 347.5, not 360</span>
                    <span class="c1">#print(hi_phi, lo_phi)</span>

                <span class="c1"># print(phis[j], hi_phi, lo_phi)</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">hi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">hi_phi</span><span class="p">][</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">param</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key error found when indexing </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> for hi. Likely a case of the data being zero for the adjacent point, setting to 0...&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="n">hi</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">lo_phi</span><span class="p">][</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">param</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key error found when indexing </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> for lo. Likely a case of the data being zero for the adjacent point, setting to 0...&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                    <span class="n">lo</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">if</span> <span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">grad_phi_param</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">hi_phi</span> <span class="o">-</span> <span class="n">lo_phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grad_phi_param</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># I guess? Shouldn&#39;t actually come up</span>

                <span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">:</span> <span class="n">grad_r_param</span> <span class="p">}</span> <span class="p">)</span>
                <span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_phi&#39;</span><span class="p">:</span> <span class="n">grad_phi_param</span> <span class="p">}</span> <span class="p">)</span>
                <span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_phinor&#39;</span><span class="p">:</span> <span class="n">grad_phi_param</span><span class="o">*</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>

                <span class="k">if</span> <span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_y&#39;</span><span class="p">:</span> <span class="n">grad_r_param</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_angle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi_angle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">grad_phi_param</span> <span class="p">}</span> <span class="p">)</span>
                    <span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_x&#39;</span><span class="p">:</span> <span class="n">grad_r_param</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi_angle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_angle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">grad_phi_param</span> <span class="p">}</span> <span class="p">)</span>

                <span class="n">r_dict</span><span class="p">[</span><span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_total&#39;</span><span class="p">:</span> <span class="n">grad_r_param</span><span class="o">+</span><span class="n">grad_phi_param</span> <span class="p">}</span> <span class="p">)</span>
                
                
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># first point, also calculate derivative at 0, using grad_r_param</span>
                
                    <span class="c1"># x and y only a function of r, dψ/dφ = 0</span>
                    <span class="k">if</span> <span class="n">phi_angle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># r_dict[0.0].update( {grad_param_name+&#39;_x&#39;: grad_r_param * np.cos(phi_angle) } )</span>
                        <span class="c1"># Copy to all other angles</span>
                        <span class="k">for</span> <span class="n">temp_angle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">temp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_x&#39;</span><span class="p">:</span> <span class="n">grad_r_param</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi_angle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="p">}</span> <span class="p">)</span>
                    
                    <span class="k">elif</span> <span class="n">phi_angle</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
                        <span class="c1"># r_dict[0.0].update( {grad_param_name+&#39;_y&#39;: grad_r_param * np.sin(phi_angle) } )</span>
                        <span class="c1"># Copy to all other angles</span>
                        <span class="k">for</span> <span class="n">temp_angle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angles</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">temp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_y&#39;</span><span class="p">:</span> <span class="n">grad_r_param</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_angle</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="p">}</span> <span class="p">)</span>


                    <span class="k">if</span> <span class="n">phi_angle</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">:</span>
                        <span class="n">comp_angle</span> <span class="o">=</span> <span class="n">phi_angle</span> <span class="o">+</span> <span class="mi">180</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">comp_angle</span> <span class="o">=</span> <span class="n">phi_angle</span> <span class="o">-</span> <span class="mi">180</span>
                    
                    <span class="c1"># Want to average dψ/dr between current phi angle and complementary angle</span>

                    <span class="k">if</span> <span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">][</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">grad_r_param</span>
                        <span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">grad_r_param</span><span class="p">}</span> <span class="p">)</span>

                    
                    <span class="k">if</span> <span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">][</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">grad_r_param</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span> <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">grad_r_param</span><span class="p">}</span> <span class="p">)</span>
                        
                    
                    <span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_phi&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span> <span class="p">)</span>     
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_phi&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">})</span>

                    <span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_phinor&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">}</span> <span class="p">)</span>     
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_phinor&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="p">})</span>

                    <span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_total&#39;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">][</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">])}</span> <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">][</span><span class="mf">0.0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_total&#39;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">r_dict</span><span class="p">[</span><span class="mf">0.0</span><span class="p">][</span><span class="n">grad_param_name</span><span class="o">+</span><span class="s1">&#39;_r&#39;</span><span class="p">])</span> <span class="p">})</span>
                    

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.fit_spline">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.fit_spline">[docs]</a>
    <span class="k">def</span> <span class="nf">fit_spline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fits a RectBivariateSpline for the given param. </span>

<span class="sd">           Can access later with self.spline_interp[param]. Must specify the &#39;param&#39; to fit</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span> <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> already has a fit spline&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">(</span><span class="n">uniform_rmesh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">phi_unique</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">r_unique</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">phi_unique</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="c1"># TODO check for the 0.85 issue</span>
                <span class="n">r_unique</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rstar</span><span class="p">)</span>

        <span class="n">r_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">r_unique</span><span class="p">))</span>
        <span class="n">phi_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">phi_unique</span><span class="p">))</span>
        <span class="n">r_unique</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">phi_unique</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">phi_unique</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">rstar</span> <span class="ow">in</span> <span class="n">r_unique</span><span class="p">:</span>
                <span class="c1">#print(angle, rstar, self.phi[angle][rstar][param])</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">][</span><span class="n">rstar</span><span class="p">][</span><span class="n">param</span><span class="p">])</span>

        <span class="c1">#print(r_unique, phi_unique)</span>

        <span class="n">Vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">phi_unique</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">r_unique</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="c1">#print(Vals)</span>

        <span class="c1">#print(phi_knots, r_knots)</span>
        <span class="n">spline_interpolant</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">RectBivariateSpline</span><span class="p">(</span><span class="n">phi_unique</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="n">r_unique</span><span class="p">,</span> <span class="n">Vals</span><span class="p">,</span> <span class="n">kx</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">param</span><span class="p">:</span> <span class="n">spline_interpolant</span><span class="p">})</span>
        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.calc_linear_interp">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_linear_interp">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_linear_interp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Makes a LinearNDInterpolator for the given param. </span>
<span class="sd">        </span>
<span class="sd">            Access with self.linear_interp[param], phi in radians</span>
<span class="sd">             </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span> <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> already has a linear interpolator&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span><span class="p">)</span>
                <span class="n">phis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rstar</span><span class="p">,</span> <span class="s2">&quot;has no &quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

        <span class="n">linear_interpolant</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">LinearNDInterpolator</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">rs</span><span class="p">)),</span> <span class="n">vals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">param</span><span class="p">:</span> <span class="n">linear_interpolant</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.calc_linear_xy_interp">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_linear_xy_interp">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_linear_xy_interp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Makes a LinearNDInterpolator for the given param in x y coords</span>
<span class="sd">        </span>
<span class="sd">        Can access  with self.linear_xy_interp[param]</span>
<span class="sd">                          </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span> <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_xy_interp</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linear_xy_interp</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_xy_interp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> already has a linear interpolator in xy space&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="n">xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">))</span>
                <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rstar</span><span class="p">,</span> <span class="s2">&quot;has no &quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

        <span class="n">linear_interpolant</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">LinearNDInterpolator</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)),</span> <span class="n">vals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear_xy_interp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">param</span><span class="p">:</span> <span class="n">linear_interpolant</span><span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.max">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.max">[docs]</a>
    <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return maximum value of param in the Condition</span>
<span class="sd">        </span>
<span class="sd">        By default, saves the data to a dictionary, Condition.maxs</span>
<span class="sd">        for future reference, unless recalc=True</span>
<span class="sd">                          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">recalc</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxs</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="c1"># why waste time </span>
        <span class="nb">max</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
                    <span class="nb">max</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                    <span class="n">location</span> <span class="o">=</span> <span class="n">rstar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">param</span><span class="p">:</span><span class="nb">max</span><span class="p">})</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">max</span><span class="p">)</span></div>


<div class="viewcode-block" id="Condition.max_loc">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.max_loc">[docs]</a>
    <span class="k">def</span> <span class="nf">max_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return location of maximum param in the Condition</span>
<span class="sd">        </span>
<span class="sd">        returns in the form (r/R, angle in degrees)</span>
<span class="sd">                          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
                    <span class="nb">max</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                    <span class="n">location</span> <span class="o">=</span> <span class="p">(</span><span class="n">rstar</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">location</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Condition.min">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.min">[docs]</a>
    <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recalc</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">nonzero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return minimum value of param in the Condition</span>
<span class="sd">        </span>
<span class="sd">        By default, saves the data to a dictionary, Condition.mins</span>
<span class="sd">        for future reference, unless recalc=True</span>

<span class="sd">        nonzero=True will find the smallest nonzero value.</span>
<span class="sd">                          </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mins</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">recalc</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mins</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="c1"># why waste time </span>
        <span class="nb">min</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                
                <span class="k">if</span> <span class="n">nonzero</span> <span class="ow">and</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                
                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">:</span>
                    <span class="nb">min</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                    <span class="n">location</span> <span class="o">=</span> <span class="n">rstar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mins</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">param</span><span class="p">:</span><span class="nb">min</span><span class="p">})</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">min</span><span class="p">)</span></div>


<div class="viewcode-block" id="Condition.min_loc">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.min_loc">[docs]</a>
    <span class="k">def</span> <span class="nf">min_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return minimum value of param in the Condition</span>
<span class="sd">        </span>
<span class="sd">        By default, saves the data to a dictionary, Condition.mins</span>
<span class="sd">        for future reference, unless recalc=True</span>

<span class="sd">        nonzero option not implemented, TODO</span>
<span class="sd">                          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">min</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">7</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">:</span>
                    <span class="nb">min</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                    <span class="n">location</span> <span class="o">=</span> <span class="p">(</span><span class="n">rstar</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">location</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Condition.max_line_loc">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.max_line_loc">[docs]</a>
    <span class="k">def</span> <span class="nf">max_line_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return r/R location of maximum value of param at a given angle</span>
<span class="sd">                          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
                <span class="nb">max</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">rstar</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">location</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Condition.max_line">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.max_line">[docs]</a>
    <span class="k">def</span> <span class="nf">max_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return maximum value of param at a given angle</span>
<span class="sd">                          </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">max</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
                <span class="nb">max</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">rstar</span>

        <span class="k">return</span> <span class="p">(</span><span class="nb">max</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Condition.find_hstar_pos">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.find_hstar_pos">[docs]</a>
    <span class="k">def</span> <span class="nf">find_hstar_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;max_dsm&#39;</span><span class="p">,</span> <span class="n">void_criteria</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the vertical distance from the top of the pipe to the bubble layer interface</span>
<span class="sd">        </span>
<span class="sd">        Methods for determining bubble layer interface</span>
<span class="sd">        - max_dsm</span>
<span class="sd">        - min_grad_y</span>
<span class="sd">        - max_grad_y</span>
<span class="sd">        - max_mag_grad_y</span>
<span class="sd">        - zero_void</span>
<span class="sd">        - percent_void, search down the phi = 90 line, find largest value of rstar where alpha &lt; min_void</span>
<span class="sd">        - Ryan_Ref, uses 1.3 - 1.57e-5 * Ref, proposed by Ryan (2022)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;max_dsm&#39;</span><span class="p">:</span>
            <span class="n">r_max</span><span class="p">,</span> <span class="n">phi_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span><span class="p">(</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">)</span>
            <span class="n">h_star</span><span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">r_max</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_max</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">h_star</span>
        
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;min_grad_y&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_grad</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
            <span class="n">r_min</span><span class="p">,</span> <span class="n">phi_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_loc</span><span class="p">(</span><span class="s1">&#39;grad_alpha_y&#39;</span><span class="p">)</span>
            <span class="n">h_star</span><span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">r_min</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_min</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">h_star</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;max_grad_y&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_grad</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
            <span class="n">r_min</span><span class="p">,</span> <span class="n">phi_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_loc</span><span class="p">(</span><span class="s1">&#39;grad_alpha_y&#39;</span><span class="p">)</span>
            <span class="n">h_star</span><span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">r_min</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_min</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">h_star</span>
        
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;max_mag_grad_y&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calc_grad</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">void_criteria</span><span class="p">:</span>
                    <span class="k">pass</span>
                    <span class="c1">#TODO finish this</span>
            <span class="n">h_star</span><span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">roverRend</span>
            <span class="k">return</span> <span class="n">h_star</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;zero_void&#39;</span><span class="p">:</span>
            <span class="c1"># search down the phi = 90 line, find largest value of rstar where alpha &lt; min_void</span>
            <span class="n">roverRend</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">max_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_line_loc</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
            <span class="n">max_void</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_line</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">void_criteria</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;</span> <span class="n">roverRend</span> <span class="ow">and</span> <span class="n">rstar</span> <span class="o">&lt;</span> <span class="n">max_loc</span><span class="p">:</span>
                        <span class="n">roverRend</span> <span class="o">=</span> <span class="n">rstar</span>
            
            <span class="k">if</span> <span class="n">roverRend</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># Didn&#39;t find it on the positive side</span>
                <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">270</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">void_criteria</span><span class="p">:</span>
                        <span class="k">if</span> <span class="o">-</span><span class="n">rstar</span> <span class="o">&gt;</span> <span class="n">roverRend</span><span class="p">:</span>
                            <span class="n">roverRend</span> <span class="o">=</span> <span class="o">-</span><span class="n">rstar</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">roverRend</span> <span class="o">=</span> <span class="n">roverRend</span>
            <span class="n">h_star</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">roverRend</span>
            <span class="k">return</span> <span class="n">h_star</span>
        
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;percent_void&#39;</span><span class="p">:</span>
            <span class="c1"># search down the phi = 90 line, find largest value of rstar where alpha &lt; min_void</span>
            <span class="n">roverRend</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">max_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_line_loc</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
            <span class="n">max_void</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_line</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_void</span> <span class="o">*</span> <span class="n">void_criteria</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;</span> <span class="n">roverRend</span> <span class="ow">and</span> <span class="n">rstar</span> <span class="o">&lt;</span> <span class="n">max_loc</span><span class="p">:</span>
                        <span class="n">roverRend</span> <span class="o">=</span> <span class="n">rstar</span>
            
            <span class="k">if</span> <span class="n">roverRend</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">180</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_void</span> <span class="o">*</span> <span class="n">void_criteria</span><span class="p">:</span>
                        <span class="k">if</span> <span class="o">-</span><span class="n">rstar</span> <span class="o">&gt;</span> <span class="n">roverRend</span><span class="p">:</span>
                            <span class="n">roverRend</span> <span class="o">=</span> <span class="o">-</span><span class="n">rstar</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">roverRend</span> <span class="o">=</span> <span class="n">roverRend</span>
            <span class="n">h_star</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">roverRend</span>
            <span class="k">return</span> <span class="n">h_star</span>
        
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Ryan_Ref&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ref</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> has no Ref value, calculating assuming water&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ref</span> <span class="o">=</span> <span class="mi">998</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="mf">0.001</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">roverRend</span> <span class="o">=</span> <span class="mf">1.3</span> <span class="o">-</span> <span class="mf">1.57e-5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ref</span>
            <span class="n">h_star</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">roverRend</span>
            <span class="k">return</span> <span class="n">h_star</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Invalid method for find_h_pos&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span></div>


<div class="viewcode-block" id="Condition.avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.avg">[docs]</a>
    <span class="k">def</span> <span class="nf">avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">include_nonzero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates a basic average of a parameter, &quot;param&quot;</span>
<span class="sd">        </span>
<span class="sd">        Just looks at every param and ensemble-averages them</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">avg_param</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                
                <span class="k">if</span> <span class="n">include_nonzero</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">avg_param</span> <span class="o">+=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">avg_param</span> <span class="o">+=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">avg_param</span> <span class="o">/</span> <span class="n">count</span></div>


<div class="viewcode-block" id="Condition.area_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.area_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">area_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">even_opt</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">recalc</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating the area-average of a parameter, &quot;param&quot;</span>
<span class="sd">        </span>
<span class="sd">        param can be anything MIDAS outputs, but usually of interest are &quot;alpha&quot; or &quot;alpha_ug&quot;</span>
<span class="sd">        If you&#39;re not sure what somethings named, try Condition.phi[90][1.0].keys()</span>

<span class="sd">        Uses Simpson&#39;s rule for integration, even_opt passed to that. Will save the previously calculated area averages </span>
<span class="sd">        in Condition.area_avgs[param], and won&#39;t recalculate unless recalc = True</span>

<span class="sd">        Returns the area-averaged parameter, or None if the method failed</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Check that the parameter that the user requested exists</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">][</span><span class="mf">1.0</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avgs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">recalc</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avgs</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="c1"># why waste time, if we already calculated this don&#39;t do it again</span>
        
        <span class="c1"># We have to integrate twice, once with resepect to r, again with respect to phi</span>
        <span class="c1"># Start with r</span>

        <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># array for parameter integrated wrt r</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mirrored</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Mirroring in area-avg&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>


        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">rs_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vars_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># This should be unnecessary now with the new mirror, but it&#39;s not hurting anyone by being here</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">rs_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">rstar</span> <span class="p">)</span> <span class="c1"># This is proably equivalent to rs = list(r_dict.keys() ), but I&#39;m paranoid about ordering</span>
                        <span class="n">vars_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">*</span> <span class="n">rstar</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Problem with:&#39;</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
                    <span class="c1">#if debug: print(angle, midas_dict, file=debugFID)</span>
            
            
            <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">,</span> <span class="n">vars_temp</span><span class="p">))]</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arrays to integrate&quot;</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="nb">vars</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">vars</span><span class="p">):</span>
                <span class="ne">ValueError</span><span class="p">(</span> <span class="sa">f</span><span class="s2">&quot;rs to integrate over </span><span class="si">{</span><span class="n">rs</span><span class="si">}</span><span class="s2"> must be the same length as params </span><span class="si">{</span><span class="nb">vars</span><span class="si">}</span><span class="s2">, occured at </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">)</span>
                
            <span class="k">try</span><span class="p">:</span>
                <span class="n">param_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># Integrate wrt r</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="nb">vars</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculated integral:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="c1">#I = 2 * np.pi</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Integrated wrt r&quot;</span><span class="p">,</span> <span class="n">param_r</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">param_r</span><span class="p">))]</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>

        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">param_r</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="c1"># Integrate wrt theta, divide by normalized area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area_avgs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">param</span><span class="p">:</span> <span class="n">I</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.circ_segment_area_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.circ_segment_area_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">circ_segment_area_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">hstar</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">ngridr</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">ngridphi</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">int_err</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating the area-average of a parameter, &quot;param&quot; over the circular segment defined by h</span>
<span class="sd">        </span>
<span class="sd">        Basically, if you slice the pipe at h, area average everything above h</span>

<span class="sd">        to smooth it out, integrate over an interpolated mesh</span>

<span class="sd">        returns integrand result</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check that the parameter that the user requested exists</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">][</span><span class="mf">1.0</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">r_star</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_star</span><span class="p">)</span>
                <span class="n">phis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">*</span> <span class="n">r_star</span><span class="p">)</span> <span class="c1"># Don&#39;t forget r dr dθ</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span> <span class="o">*</span> <span class="n">r_star</span><span class="p">)</span> <span class="c1"># Don&#39;t forget r dr dθ</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for φ = </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, r = </span><span class="si">{</span><span class="n">r_star</span><span class="si">}</span><span class="s2">. Substituting NaN&quot;</span><span class="p">)</span>

        <span class="c1"># Set up interpolation</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phis</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>   

        <span class="n">interp</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">LinearNDInterpolator</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">phis</span><span class="p">)),</span> <span class="n">vals</span><span class="p">)</span>

        <span class="c1"># To integrate, need to get the bounds. They&#39;re different depending on if h* &gt; 1</span>
        <span class="k">def</span> <span class="nf">lower_r_bound_pos</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hstar</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">upper_r_bound_neg</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">phi</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">hstar</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">phi</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">hstar</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hstar</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">dumb_func</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span> <span class="c1"># For area integration</span>
            <span class="k">return</span> <span class="n">r</span>

        <span class="k">if</span> <span class="n">hstar</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">interp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">lower_r_bound_pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">dumb_func</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">lower_r_bound_pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">hstar</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">interp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upper_r_bound_neg</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">dumb_func</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upper_r_bound_neg</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.circ_segment_void_area_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.circ_segment_void_area_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">circ_segment_void_area_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">hstar</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">ngridr</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">ngridphi</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">int_err</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating the void-weighted area-average of a parameter over the circular segment defined by h</span>
<span class="sd">        </span>
<span class="sd">        Basically, if you slice the pipe at h, void-weighted area average everything above h</span>
<span class="sd">        </span>
<span class="sd">        to smooth it out, integrate over an interpolated mesh</span>

<span class="sd">        returns integrand result</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check that the parameter that the user requested exists</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">][</span><span class="mf">1.0</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">r_star</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_star</span><span class="p">)</span>
                <span class="n">phis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
                <span class="n">denom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_star</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">*</span> <span class="n">r_star</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span> <span class="c1"># Don&#39;t forget r dr dθ</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span> <span class="o">*</span> <span class="n">r_star</span><span class="p">)</span> <span class="c1"># Don&#39;t forget r dr dθ</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for φ = </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, r = </span><span class="si">{</span><span class="n">r_star</span><span class="si">}</span><span class="s2">. Substituting NaN&quot;</span><span class="p">)</span>

        <span class="c1"># Set up interpolation</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phis</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>   
        <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>   

        <span class="n">interp</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">LinearNDInterpolator</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">phis</span><span class="p">)),</span> <span class="n">vals</span><span class="p">)</span>
        <span class="n">interp2</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">LinearNDInterpolator</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">phis</span><span class="p">)),</span> <span class="n">denom</span><span class="p">)</span>

        <span class="c1"># To integrate, need to get the bounds. They&#39;re different depending on if h* &gt; 1</span>
        <span class="k">def</span> <span class="nf">lower_r_bound_pos</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hstar</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">upper_r_bound_neg</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">phi</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">hstar</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">phi</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">hstar</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hstar</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hstar</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">interp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">lower_r_bound_pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">interp2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">lower_r_bound_pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">hstar</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">interp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upper_r_bound_neg</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">interp2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upper_r_bound_neg</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.line_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.line_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">line_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">phi_angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">even_opt</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Line average of param over line defined by phi_angle</span>
<span class="sd">        </span>
<span class="sd">        Also includes the complementary angle, so the line is a diameter of the pipe</span>

<span class="sd">        returns integrand result</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check that the parameter that the user requested exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">phi_angle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">Data for </span><span class="si">{</span><span class="n">phi_angle</span><span class="si">}</span><span class="s2"> not found after mirroring!&quot;</span><span class="p">)</span>
            <span class="k">return</span>


        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">][</span><span class="mf">1.0</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">r_for_int</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">var_for_int</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">phi_angle</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">rstar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_for_int</span><span class="p">:</span>
                <span class="n">r_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span><span class="p">)</span>
                <span class="n">var_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">phi_angle</span> <span class="o">&lt;=</span><span class="mi">180</span><span class="p">:</span>
            <span class="n">comp_angle</span> <span class="o">=</span> <span class="n">phi_angle</span><span class="o">+</span><span class="mi">180</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_angle</span> <span class="o">=</span> <span class="n">phi_angle</span> <span class="o">-</span> <span class="mi">180</span>
        
        <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">rstar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_for_int</span><span class="p">:</span>
                <span class="n">r_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">rstar</span><span class="p">)</span>
                <span class="n">var_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>

        <span class="n">var_for_int</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">r_for_int</span><span class="p">,</span> <span class="n">var_for_int</span><span class="p">))]</span>
        <span class="n">r_for_int</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">r_for_int</span><span class="p">)</span>

        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">var_for_int</span><span class="p">,</span> <span class="n">r_for_int</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1"># Integrate wrt theta, divide by normalized length</span>

        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.line_avg_dev">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.line_avg_dev">[docs]</a>
    <span class="k">def</span> <span class="nf">line_avg_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">phi_angle</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">even_opt</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Second moment of param over line defined by phi_angle</span>
<span class="sd">        </span>
<span class="sd">        Also includes the complementary angle, so the line is a diameter of the pipe</span>

<span class="sd">        &lt; param - &lt;param&gt;^2 &gt; / &lt;param&gt;^2</span>

<span class="sd">        returns integrand result</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check that the parameter that the user requested exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">phi_angle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">Data for </span><span class="si">{</span><span class="n">phi_angle</span><span class="si">}</span><span class="s2"> not found after mirroring!&quot;</span><span class="p">)</span>
            <span class="k">return</span>


        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">][</span><span class="mf">1.0</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">r_for_int</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">var_for_int</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">phi_angle</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">rstar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_for_int</span><span class="p">:</span>
                <span class="n">r_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span><span class="p">)</span>
                <span class="n">var_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="n">param</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">phi_angle</span> <span class="o">&lt;=</span><span class="mi">180</span><span class="p">:</span>
            <span class="n">comp_angle</span> <span class="o">=</span> <span class="n">phi_angle</span><span class="o">+</span><span class="mi">180</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_angle</span> <span class="o">=</span> <span class="n">phi_angle</span> <span class="o">-</span> <span class="mi">180</span>
        
        <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">comp_angle</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">rstar</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r_for_int</span><span class="p">:</span>
                <span class="n">r_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">rstar</span><span class="p">)</span>
                <span class="n">var_for_int</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="n">param</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">var_for_int</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">r_for_int</span><span class="p">,</span> <span class="n">var_for_int</span><span class="p">))]</span>
        <span class="n">r_for_int</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">r_for_int</span><span class="p">)</span>

        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">var_for_int</span><span class="p">,</span> <span class="n">r_for_int</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># Integrate wrt theta, divide by normalized length</span>

        <span class="k">return</span> <span class="n">I</span></div>



<div class="viewcode-block" id="Condition.void_area_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.void_area_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">void_area_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">even_opt</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating the void-weighted area-average of a parameter</span>
<span class="sd">        </span>
<span class="sd">        &lt;alpha * param&gt; / &lt;alpha&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check that the parameter that the user requested exists</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">][</span><span class="mf">1.0</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="c1"># We have to integrate twice, once with resepect to r, again with respect to phi</span>
        <span class="c1"># Start with r</span>

        <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># array for parameter integrated wrt r</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>


        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">rs_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vars_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># This should be unnecessary now with the new mirror, but it&#39;s not hurting anyone by being here</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">rs_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">rstar</span> <span class="p">)</span> <span class="c1"># This is proably equivalent to rs = list(r_dict.keys() ), but I&#39;m paranoid about ordering</span>
                        <span class="n">vars_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">rstar</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Problem with:&#39;</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
                    <span class="c1">#if debug: print(angle, midas_dict, file=debugFID)</span>
            
            
            <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">,</span> <span class="n">vars_temp</span><span class="p">))]</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arrays to integrate&quot;</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="nb">vars</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                
            <span class="n">param_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># Integrate wrt r</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculated integral:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="c1">#I = 2 * np.pi</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Integrated wrt r&quot;</span><span class="p">,</span> <span class="n">param_r</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">param_r</span><span class="p">))]</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>

        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">param_r</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span> <span class="c1"># Integrate wrt theta, divide by normalized area</span>
        <span class="k">return</span> <span class="n">I</span></div>

    
<div class="viewcode-block" id="Condition.interp_area_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.interp_area_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">interp_area_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">interp_type</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to area-average param, using the spline interpolation of param</span>

<span class="sd">        Returns the intengrand result. May be computationally expensive</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">interp_type</span> <span class="o">==</span> <span class="s1">&#39;spline&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fit_spline</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phi</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
        
        <span class="k">elif</span> <span class="n">interp_type</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_linear_interp</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phi</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
        
        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.spline_void_area_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.spline_void_area_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">spline_void_area_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to void-weighted area-average param over a circular segment defined by h, using the spline interpolation of param</span>

<span class="sd">        Returns the intengrand result. May be computationally expensive</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phi</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">](</span><span class="n">phi</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
        
        <span class="k">def</span> <span class="nf">integrand_denom</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">](</span><span class="n">phi</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>
        
        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">integrand_denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">I</span></div>

    
<div class="viewcode-block" id="Condition.spline_circ_seg_area_avg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.spline_circ_seg_area_avg">[docs]</a>
    <span class="k">def</span> <span class="nf">spline_circ_seg_area_avg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">hstar</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">int_err</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to area-average over a circular segment defined by h, using the spline interpolation of param</span>

<span class="sd">        Returns the intengrand result. May be computationally expensive</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phi</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span>

        <span class="k">def</span> <span class="nf">integrand_denom</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">r</span>

        <span class="k">def</span> <span class="nf">lower_r_bound_pos</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hstar</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">upper_r_bound_neg</span><span class="p">(</span><span class="n">phi</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">phi</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">hstar</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">phi</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">hstar</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hstar</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hstar</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">lower_r_bound_pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">integrand_denom</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> <span class="n">lower_r_bound_pos</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">hstar</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upper_r_bound_neg</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">integrand_denom</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upper_r_bound_neg</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="n">int_err</span> <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.calc_void_cov">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_void_cov">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_void_cov</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the void covariance</span>

<span class="sd">        Returns &lt;alpha^2&gt;/&lt;alpha&gt;^2</span>

<span class="sd">        Stored in self.void_cov</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># integrated wrt r</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rs_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vars_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rs_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">rstar</span> <span class="p">)</span> <span class="c1"># This is proably equivalent to rs = list(r_dict.keys() ), but I&#39;m paranoid about ordering</span>
                    <span class="n">vars_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">midas_dict</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            
            <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">,</span> <span class="n">vars_temp</span><span class="p">))]</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arrays to integrate&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="nb">vars</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                
            <span class="n">param_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># Integrate wrt r</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculated integral:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="c1">#I = 2 * np.pi</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Integrated wrt r&quot;</span><span class="p">,</span> <span class="n">param_r</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
        <span class="n">param_r_int</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">param_r</span><span class="p">))]</span>
        <span class="n">angles_int</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">param_r_int</span><span class="p">,</span> <span class="n">angles_int</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># Integrate wrt theta, divide by normalized area</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">void_cov</span> <span class="o">=</span> <span class="n">I</span>
        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.calc_sigma_alpha">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_sigma_alpha">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_sigma_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the second moment of alpha</span>

<span class="sd">        Returns &lt;(alpha-&lt;alpha&gt;)^2&gt;/&lt;alpha&gt;^2</span>

<span class="sd">        Stored in self.sigma_alpha</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># integrated wrt r</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="n">alpha_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rs_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vars_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rs_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">rstar</span> <span class="p">)</span> <span class="c1"># This is proably equivalent to rs = list(r_dict.keys() ), but I&#39;m paranoid about ordering</span>
                    <span class="n">vars_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span> <span class="o">*</span> <span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">alpha_avg</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">midas_dict</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            
            <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">,</span> <span class="n">vars_temp</span><span class="p">))]</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arrays to integrate&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="nb">vars</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                
            <span class="n">param_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># Integrate wrt r</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculated integral:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="c1">#I = 2 * np.pi</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Integrated wrt r&quot;</span><span class="p">,</span> <span class="n">param_r</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
        <span class="n">param_r_int</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">param_r</span><span class="p">))]</span>
        <span class="n">angles_int</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">param_r_int</span><span class="p">,</span> <span class="n">angles_int</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">alpha_avg</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># Integrate wrt theta, divide by normalized area</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calculated sigma_alpha: &#39;</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_alpha</span> <span class="o">=</span> <span class="n">I</span>
        <span class="k">return</span> <span class="n">I</span></div>

    
<div class="viewcode-block" id="Condition.calc_mu3_alpha">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_mu3_alpha">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_mu3_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the third moment of alpha</span>

<span class="sd">        Returns &lt;(alpha-&lt;alpha&gt;)^3&gt;/&lt;alpha&gt;^3</span>

<span class="sd">        Stored in self.mu3_alpha</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># integrated wrt r</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="n">alpha_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rs_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vars_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rs_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">rstar</span> <span class="p">)</span> <span class="c1"># This is proably equivalent to rs = list(r_dict.keys() ), but I&#39;m paranoid about ordering</span>
                    <span class="n">vars_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rstar</span> <span class="o">*</span> <span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">alpha_avg</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">midas_dict</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            
            <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">,</span> <span class="n">vars_temp</span><span class="p">))]</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arrays to integrate&quot;</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="nb">vars</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                
            <span class="n">param_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># Integrate wrt r</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculated integral:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="c1">#I = 2 * np.pi</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Integrated wrt r&quot;</span><span class="p">,</span> <span class="n">param_r</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
        <span class="n">param_r_int</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">param_r</span><span class="p">))]</span>
        <span class="n">angles_int</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">param_r_int</span><span class="p">,</span> <span class="n">angles_int</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">alpha_avg</span><span class="o">**</span><span class="mi">3</span> <span class="c1"># Integrate wrt theta, divide by normalized area</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calculated mu3_alpha: &#39;</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mu3_alpha</span> <span class="o">=</span> <span class="n">I</span>
        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.top_bottom">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.top_bottom">[docs]</a>
    <span class="k">def</span> <span class="nf">top_bottom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">even_opt</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Honestly, I forgot what this does</span>

<span class="sd">        I think it area-averages the way Bottin did, which is not</span>
<span class="sd">        a good way of doing so. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Check that the parameter that the user requested exists</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="mi">90</span><span class="p">][</span><span class="mf">1.0</span><span class="p">][</span><span class="n">param</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KeyError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cound not area-average </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for condition </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="c1"># We have to integrate twice, once with resepect to r, again with respect to phi</span>
        <span class="c1"># Start with r</span>

        <span class="n">I</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># array for parameter integrated wrt r</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">rs_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vars_temp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span> <span class="c1"># Convert degrees to radians</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">rstar</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># This should be unnecessary now with the new mirror, but it&#39;s not hurting anyone by being here</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">rs_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">rstar</span> <span class="p">)</span> <span class="c1"># This is proably equivalent to rs = list(r_dict.keys() ), but I&#39;m paranoid about ordering</span>
                        <span class="n">vars_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">*</span> <span class="n">rstar</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Problem with:&#39;</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
                    <span class="c1">#if debug: print(angle, midas_dict, file=debugFID)</span>
            
            
            <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">,</span> <span class="n">vars_temp</span><span class="p">))]</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rs_temp</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Arrays to integrate&quot;</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="nb">vars</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                
            <span class="n">param_r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># Integrate wrt r</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculated integral:&quot;</span><span class="p">,</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">),</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
                <span class="c1">#I = 2 * np.pi</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Integrated wrt r&quot;</span><span class="p">,</span> <span class="n">param_r</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>

        <span class="n">param_r</span> <span class="o">=</span> <span class="p">[</span><span class="n">param</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">param_r</span><span class="p">))]</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>

        <span class="n">I</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">param_r</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="n">even_opt</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="c1"># Integrate wrt theta, divide by normalized area</span>
        <span class="k">return</span> <span class="n">I</span></div>


<div class="viewcode-block" id="Condition.calc_dpdz">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_dpdz">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_dpdz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;LM&#39;</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mf">0.316</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">LM_C</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">k_m</span> <span class="o">=</span> <span class="mf">0.10</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mi">9999</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculates the pressure gradient, dp/dz, according to various methods. Can access later with self.dpdz</span>

<span class="sd">        Options:</span>
<span class="sd">            - method    : Calculation method</span>
<span class="sd">                &gt; &#39;LM&#39;  : Lockhart Martinelli, assuming turbulent-turbulent, C = LM_C</span>
<span class="sd">                &gt; &#39;Kim&#39; : Kim-modified Lockhart Martinelli</span>
<span class="sd">            - rho_f     : Liquid phase density</span>
<span class="sd">            - rho_g     : Gas phase density</span>
<span class="sd">            - mu_f      : Liquid phase dynamic viscosity</span>
<span class="sd">            - mu_g      : Gas phase dynamic viscosity</span>
<span class="sd">            - m         : Blasius formulation coefficient (Darcy friction factor)</span>
<span class="sd">            - n         : Blasius formulation coefficient (Darcy friction factor)</span>
<span class="sd">            - LM_C      : Chisholm parameter</span>
<span class="sd">            - k_m       : Minor loss coefficient</span>
<span class="sd">            - L         : Length of restriction, only matters for &#39;Kim&#39; method</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;LM&#39;</span><span class="p">:</span>
            <span class="n">Re_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_f</span>
            <span class="n">Re_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_g</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_g</span>

            <span class="n">f_f</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">Re_f</span><span class="o">**</span><span class="n">n</span>
            <span class="n">f_g</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">Re_g</span><span class="o">**</span><span class="n">n</span>

            <span class="n">phi_f2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">LM_C</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">chi2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">chi2</span>
            <span class="n">dpdz</span> <span class="o">=</span> <span class="n">phi_f2</span> <span class="o">*</span> <span class="n">dpdz_f</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Kim&#39;</span><span class="p">:</span>
            <span class="n">Re_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_f</span>
            <span class="n">Re_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_g</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_g</span>

            <span class="n">f_f</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">Re_f</span><span class="o">**</span><span class="n">n</span>
            <span class="n">f_g</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">Re_g</span><span class="o">**</span><span class="n">n</span>

            <span class="n">dpdz_f</span> <span class="o">=</span> <span class="n">f_f</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">dpdz_g</span> <span class="o">=</span> <span class="n">f_g</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Dh</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_g</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">dpdz_m</span> <span class="o">=</span> <span class="n">k_m</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">L</span>

            <span class="n">chi2</span> <span class="o">=</span> <span class="n">dpdz_f</span> <span class="o">/</span> <span class="n">dpdz_g</span>
            <span class="n">chiM2</span> <span class="o">=</span> <span class="n">dpdz_f</span> <span class="o">/</span> <span class="n">dpdz_m</span>

            <span class="n">phi_f2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">chiM2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">chiM2</span><span class="p">)</span> <span class="o">*</span> <span class="n">LM_C</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">chi2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">chi2</span>
            <span class="n">dpdz</span> <span class="o">=</span> <span class="n">phi_f2</span> <span class="o">*</span> <span class="n">dpdz_f</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1"> is not a valid option for calc_dpdz. Try &quot;LM&quot; &#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dpdz</span> <span class="o">=</span> <span class="n">dpdz</span>

        <span class="k">return</span> <span class="n">dpdz</span></div>


<div class="viewcode-block" id="Condition.calc_vwvg">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_vwvg">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_vwvg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates void weighted Vgj</span>

<span class="sd">        uses self.jgloc / self.area_avg(&#39;alpha&#39;), which is not a great method</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This guy needs work, probably don&#39;t want to use it&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vwvg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Condition.calc_W">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_W">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_W</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the wake deficit function, W, from the experimental data</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">vfp</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">calc_vr</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">vfp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, vf = 0 but vr != 0. Defaulting to W = 0&quot;</span><span class="p">)</span>
                    <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                            <span class="s1">&#39;W&#39;</span> <span class="p">:</span> <span class="mi">0</span>
                        <span class="p">})</span>
                <span class="k">else</span><span class="p">:</span>

                    <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                        <span class="s1">&#39;W&#39;</span> <span class="p">:</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">vfp</span>
                    <span class="p">})</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.calc_mu_eff">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_mu_eff">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_mu_eff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Ishii&#39;</span><span class="p">,</span> <span class="n">alpha_max</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for effective/mixture viscosity</span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">         - method, what method to use for modeling :math:`\\mu_{eff}`</span>
<span class="sd">         - alpha_max, parameter for some models</span>
<span class="sd">        </span>
<span class="sd">        Stores:</span>
<span class="sd">         - &quot;mu_eff&quot; in midas_dict </span>
<span class="sd">         - &quot;mu_m&quot; in midas_dict</span>

<span class="sd">        Options for method:</span>
<span class="sd">         - Ishii, :math:`\\mu_{eff} = \\mu_{m} = \\mu_{f} (1 - \\frac{\\alpha}{ \\alpha_{max} })^{-2.5 \\alpha_{max} \\frac{\\mu_g + 0.4 \\mu_g}{\\mu_g + \\mu_g} }`</span>

<span class="sd">        Returns:</span>
<span class="sd">         - area average effective viscosity</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>
                
        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ishii&#39;</span><span class="p">:</span>
                    <span class="n">mu_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_f</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">alpha_max</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">alpha_max</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_g</span> <span class="o">+</span> <span class="mf">0.4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_f</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_g</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_f</span><span class="p">)</span>  <span class="p">)</span>
                    <span class="n">mu_eff</span> <span class="o">=</span> <span class="n">mu_m</span>

                    <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;mu_m&#39;</span><span class="p">:</span> <span class="n">mu_eff</span><span class="p">})</span>

                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;mu_eff&#39;</span><span class="p">:</span> <span class="n">mu_eff</span><span class="p">})</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;mu_eff&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="Condition.calc_cd">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_cd">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_cd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Ishii-Zuber&#39;</span><span class="p">,</span> <span class="n">vr_cheat</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating drag coefficient</span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">         - method, what method to use for modeling :math:`C_{D}`</span>
<span class="sd">         - vr_cheat, flag to use &quot;vr&quot; from midas_dict or &quot;vr_model&quot; when calculating :math:`Re_{b}`</span>
<span class="sd">         - limit, if supplied, will limit the drag coefficient to the given maximum value. For instance, 0.44 like in CFX</span>
<span class="sd">        </span>
<span class="sd">        Stores:</span>
<span class="sd">         - &quot;cd&quot; in midas_dict </span>
<span class="sd">         - &quot;Reb&quot; in midas_dict. Calculated by :math:`Re_{b} = \\frac{(1 - \\alpha) \\rho_{f} v_{r} D_{sm,1} }{\\mu_{m}}`. \ </span>
<span class="sd">:math:`\\mu_{m}` comes from :any:`calc_mu_eff`</span>

<span class="sd">        Options for method:</span>
<span class="sd">         - Ishii-Zuber, :math:`C_{D} = \\frac{24}{Re_{b}} (1 + 0.1 Re_{b}^{0.75})`</span>
<span class="sd">         - Schiller-Naumann, :math:`C_{D} = \\frac{24}{Re_{b}} (1 + 0.15 Re_{b}^{0.687})`. Here, :math:`Re_{b}` uses :math:`\\mu_{f}`</span>

<span class="sd">        Returns:</span>
<span class="sd">         - area average drag coefficient</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calc_mu_eff</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">vr_cheat</span><span class="p">:</span>
                    <span class="n">Reb</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;mu_m&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>

                    <span class="k">if</span> <span class="s1">&#39;vr_model&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">midas_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># Initialize for iteration</span>
                        <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vr_model&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>

                    <span class="n">Reb</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr_model&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;mu_m&#39;</span><span class="p">]</span>

                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;Reb&#39;</span><span class="p">:</span> <span class="n">Reb</span><span class="p">})</span>

                <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Ishii-Zuber&#39;</span> <span class="ow">or</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;IZ&#39;</span> <span class="ow">or</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Ishii&#39;</span><span class="p">:</span>

                    <span class="k">if</span> <span class="n">Reb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">cd</span> <span class="o">=</span> <span class="mi">24</span><span class="o">/</span><span class="n">Reb</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Reb</span><span class="o">**</span><span class="mf">0.75</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">cd</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;Schiller-Naumann&#39;</span><span class="p">:</span>
                    <span class="n">Reb</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr_model&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_f</span>

                    <span class="n">cd</span> <span class="o">=</span> <span class="mi">24</span><span class="o">/</span><span class="n">Reb</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">Reb</span><span class="o">**</span><span class="mf">0.687</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cd</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">cd</span><span class="p">)</span>
                <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cd&#39;</span><span class="p">:</span> <span class="n">cd</span><span class="p">})</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;cd&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Condition.calc_vr_model">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_vr_model">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_vr_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;km1_simp&#39;</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Lw</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">kf</span> <span class="o">=</span> <span class="mf">0.089</span><span class="p">,</span> <span class="n">iterate_cd</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">quiet</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating relative velocity based on models</span>
<span class="sd">        </span>
<span class="sd">        Inputs:</span>
<span class="sd">         - method, what method to use for modeling :math:`v_{r}`</span>
<span class="sd">         - kw, wake coeffieient for some models</span>
<span class="sd">         - n, exponent for some models</span>
<span class="sd">         - Lw, really :math:`L_{w}^{*}`, effective wake length divided by the bubble diameter</span>
<span class="sd">         - kf, fluid coefficient for some models</span>
<span class="sd">         - iterate_cd, flag to pass to :any:`calc_cd`. Basically whether to iterate to calculate :math:`C_{D}` based on \</span>
<span class="sd">the newly calculated :math:`v_{r}` or not</span>
<span class="sd">         - quiet, flag for extra debugging messages</span>
<span class="sd">        </span>
<span class="sd">        Stores:</span>
<span class="sd">         - &quot;vr_&#39;method_name&#39;&quot; in midas_dict </span>
<span class="sd">         - &quot;vr_model&quot; in midas_dict </span>

<span class="sd">        Options for method:</span>
<span class="sd">         - &quot;km1_simp&quot;, most up to date :math:`v_{r} = K_{f} - K_{w}  \\alpha  v_{f}  C_{d}^{1/3}`</span>
<span class="sd">         - &quot;Ishii-Chawla&quot;, :math:`v_{r} = \\sqrt{2} (\\frac{\\sigma g \\Delta \\rho}{\\rho_{f}^{2}})^{1/4}`</span>
<span class="sd">         - A bunch of obsolete ones that I haven&#39;t deleted but probably should</span>

<span class="sd">        Returns:</span>
<span class="sd">         - area average relative velocity calculated by the model</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">MAX_ITERATIONS</span> <span class="o">=</span> <span class="mi">10000</span>
        <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">initialize_vr</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">dummy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_point</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">random_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_mesh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_mesh</span><span class="p">))]</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">iterate_cd</span><span class="p">:</span>
                
                <span class="k">if</span> <span class="n">initialize_vr</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="n">midas_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                                <span class="p">{</span><span class="s1">&#39;vr_model&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">}</span>
                            <span class="p">)</span>
                    <span class="n">initialize_vr</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">calc_cd</span><span class="p">(</span><span class="n">vr_cheat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">calc_cd</span><span class="p">(</span><span class="n">vr_cheat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">old_vr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;vr_model&#39;</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">vr_name</span> <span class="o">=</span> <span class="s2">&quot;vr_&quot;</span> <span class="o">+</span> <span class="n">method</span>

            <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    
                    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;wake_1&#39;</span><span class="p">:</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">kw</span>  <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
                    
                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;wake_alpha&#39;</span><span class="p">:</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">kw</span>  <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
                    
                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;wake_alpha2&#39;</span><span class="p">:</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">kw</span>  <span class="o">*</span> <span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]))</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;wake_lambda&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">calc_avg_lat_sep</span><span class="p">()</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">kw</span>  <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;wake_vg_lambda&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">calc_avg_lat_sep</span><span class="p">()</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span> <span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kw</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>

                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hubris&#39;</span> <span class="ow">or</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;wake_vr&#39;</span><span class="p">:</span>
                        <span class="n">cd</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span>
                        <span class="n">c2</span> <span class="o">=</span> <span class="n">kw</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span><span class="n">kw</span><span class="o">*</span> <span class="n">cd</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span> <span class="n">Lw</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span> <span class="n">Lw</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span> <span class="n">c2</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cd</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span> <span class="o">*</span> <span class="n">cd</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span><span class="o">*</span> <span class="n">cd</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span><span class="o">/</span><span class="n">Lw</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)))))</span>
                    
                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;km1&#39;</span><span class="p">:</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">kw</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span>  <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Lw</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">Lw</span><span class="p">)</span> <span class="o">+</span> <span class="n">kf</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>
                    
                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;km1_simp&#39;</span><span class="p">:</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="o">-</span><span class="n">kw</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">kf</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vf&#39;</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;proper_integral&#39;</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;This method is probably no good, messed up the math&quot;</span><span class="p">)</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">Lw</span><span class="p">)</span> <span class="o">+</span> <span class="n">kw</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Lw</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)))</span>

                    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;proper_integral_alpha&#39;</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;This method is probably no good, messed up the math&quot;</span><span class="p">)</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">Lw</span><span class="p">)</span> <span class="o">+</span> <span class="n">kw</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Lw</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)))</span>

                        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">angle</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rstar</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_point</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">Lw</span><span class="p">),</span> <span class="n">kw</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;cd&#39;</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Lw</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="p">)</span>

                    <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ishii-chawla&#39;</span> <span class="ow">or</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ishii&#39;</span> <span class="ow">or</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ishii chawla&#39;</span><span class="p">:</span>
                        <span class="n">vr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho_g</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho_f</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.25</span>
                    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> not implemented&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            
                    <span class="n">midas_dict</span><span class="p">[</span><span class="n">vr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vr</span>


            <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">old_vr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vr_model calculated as 0 after </span><span class="si">{</span><span class="n">iterations</span><span class="si">}</span><span class="s2"> iterations&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">old_vr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;vr_model&#39;</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">old_vr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;vr_model&#39;</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">old_vr</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vr_model converged in </span><span class="si">{</span><span class="n">iterations</span><span class="si">}</span><span class="s2"> iterations&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">old_vr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;vr_model&#39;</span><span class="p">,</span> <span class="n">recalc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s2">&quot;vr_model&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">iterations</span> <span class="o">&gt;</span> <span class="n">MAX_ITERATIONS</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning, max iterations exceeded in calculating vr_model&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">old_vr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;vr_model&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">recalc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s2">&quot;vr_model&quot;</span><span class="p">)</span></div>


            
<div class="viewcode-block" id="Condition.calc_vgj_model">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_vgj_model">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_vgj_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for calculating local Vgj based on models</span>
<span class="sd">        </span>
<span class="sd">        midas_dict[&#39;vgj_model&#39;] = (1 - midas_dict[&#39;alpha&#39;]) * midas_dict[&#39;vr_model&#39;]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="s1">&#39;vr_model&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">midas_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: vr_model not found for </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">rstar</span><span class="si">}</span><span class="s2">, calling calc_vr_model with default inputs&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">calc_vr_model</span><span class="p">()</span>

                <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vgj_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;vr_model&#39;</span><span class="p">]</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.calc_aa_values_model">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_aa_values_model">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_aa_values_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;km1_naive&#39;</span><span class="p">,</span> <span class="n">kw</span><span class="o">=-</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">kf</span><span class="o">=-</span><span class="mf">0.083</span><span class="p">,</span> <span class="n">Lw</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Cavf</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;km1_naive&#39;</span><span class="p">:</span>
            <span class="n">vr</span> <span class="o">=</span> <span class="n">kw</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;cd&#39;</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span>  <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Lw</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">Lw</span><span class="p">)</span> <span class="o">+</span> <span class="n">kf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">))</span>
        
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;km1_naive2&#39;</span><span class="p">:</span>
            <span class="n">vr</span> <span class="o">=</span> <span class="n">kw</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;cd&#39;</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>  <span class="o">+</span> <span class="n">kf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vwvgj</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">area_avg</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">))</span><span class="o">*</span><span class="n">vr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aa_vr</span> <span class="o">=</span> <span class="n">vr</span></div>

    
<div class="viewcode-block" id="Condition.calc_errors">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_errors">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param1</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">param2</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculates the errors, ε, between two parameters (param1 - param2) in midas_dict</span>

<span class="sd">        Usually want to do param1=predicted, param2=experimental</span>
<span class="sd">        </span>
<span class="sd">        Stores:</span>
<span class="sd">         - error, &quot;eps_param1_param2&quot;, param1 - param2</span>
<span class="sd">         - relative, &quot;eps_rel_param1_param2&quot;, (param1 - param2) / param2</span>
<span class="sd">         - absolute relative, &quot;eps_abs_rel_param1_param2&quot;, | param1 - param2 | / param2</span>
<span class="sd">         - square, &quot;eps_sq_param1_param2&quot;, (param1 - param2)**2</span>
<span class="sd">         - relative square, &quot;eps_rel_sq_param1_param2&quot;, ((param1 - param2)/param2)**2</span>

<span class="sd">         If param2 = 0, relative errors are considered 0</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">param_error_name</span> <span class="o">=</span> <span class="s2">&quot;eps_&quot;</span> <span class="o">+</span> <span class="n">param1</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">param2</span>
        <span class="n">param_rel_error_name</span> <span class="o">=</span> <span class="s2">&quot;eps_rel_&quot;</span> <span class="o">+</span> <span class="n">param1</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">param2</span>
        <span class="n">param_abs_rel_error_name</span> <span class="o">=</span> <span class="s2">&quot;eps_abs_rel_&quot;</span> <span class="o">+</span> <span class="n">param1</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">param2</span>
        <span class="n">param_sq_error_name</span> <span class="o">=</span> <span class="s2">&quot;eps_sq_&quot;</span> <span class="o">+</span> <span class="n">param1</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">param2</span>
        <span class="n">param_rel_sq_error_name</span> <span class="o">=</span> <span class="s2">&quot;eps_rel_sq_&quot;</span> <span class="o">+</span> <span class="n">param1</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">param2</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param1</span><span class="p">]</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">]</span>
                <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_sq_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param1</span><span class="p">]</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>

                <span class="k">if</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_rel_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param1</span><span class="p">]</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">])</span> <span class="o">/</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">]</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_rel_sq_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param1</span><span class="p">]</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">])</span> <span class="o">/</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_abs_rel_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param1</span><span class="p">]</span> <span class="o">-</span> <span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">])</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="n">param2</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_rel_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_rel_sq_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="n">param_abs_rel_error_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.calc_avg_lat_sep">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.calc_avg_lat_sep">[docs]</a>
    <span class="k">def</span> <span class="nf">calc_avg_lat_sep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Calculates average lateral separation distance between bubbles</span>
<span class="sd">        </span>
<span class="sd">        Average lateral separation, λ given by</span>
<span class="sd">        λ = ugl / f</span>

<span class="sd">        stores in midas dict under lambda. Also estimates α based on λ,</span>

<span class="sd">        α ~ Db / λ</span>

<span class="sd">        Mirrors the data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_dict</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;ug1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;bub_freq&#39;</span><span class="p">]</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda*&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha_lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;Dsm1&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;lambda*&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
                    <span class="n">midas_dict</span><span class="p">[</span><span class="s1">&#39;alpha_lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span></div>

    
<div class="viewcode-block" id="Condition.plot_profiles">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.plot_profiles">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_profiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_axis</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> 
                      <span class="n">const_to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">22.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">include_complement</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                      <span class="n">rotate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">xlabel_loc</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                      <span class="n">set_min</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">set_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_spines</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">force_RH_y_axis</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">xlabel_loc_coords</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plot profiles of param over x_axis, for const_to_plot, i.e. α over r/R for φ = [90, 67.5 ... 0]. </span>
<span class="sd">        </span>
<span class="sd">        Include_complement will continue with the negative side if x_axis = &#39;r&#39; </span>

<span class="sd">        Also has an option to rotate the graph based on self.theta, but it&#39;s a little sketchy</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Times New Roman&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;mathtext.fontset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cm&quot;</span>

        <span class="n">log_x</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># This breaks, so I removed it from the arguments to the function</span>

        <span class="k">if</span> <span class="n">rotate</span><span class="p">:</span>

            <span class="c1"># Set up the figure to be rotated by theta</span>
            <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
            <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Affine2D</span>
            <span class="kn">import</span> <span class="nn">mpl_toolkits.axisartist.floating_axes</span> <span class="k">as</span> <span class="nn">floating_axes</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">x_axis</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
                <span class="n">plot_extents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
                <span class="n">transform</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">fig_size</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">param</span><span class="p">)),</span> <span class="n">fig_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plot_extents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span>
                <span class="n">transform</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">fig_size</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">param</span><span class="p">)),</span> <span class="n">fig_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
            
            
            <span class="n">helper</span> <span class="o">=</span> <span class="n">floating_axes</span><span class="o">.</span><span class="n">GridHelperCurveLinear</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">plot_extents</span><span class="p">)</span>
            <span class="n">fake_ax</span> <span class="o">=</span> <span class="n">floating_axes</span><span class="o">.</span><span class="n">FloatingSubplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="n">grid_helper</span><span class="o">=</span><span class="n">helper</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fake_ax</span><span class="o">.</span><span class="n">get_aux_axes</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;compressed&#39;</span><span class="p">)</span>
            <span class="n">fake_ax</span> <span class="o">=</span> <span class="n">ax</span>

        <span class="c1"># Only show ticks on the left and bottom spines</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

        <span class="c1"># Tick marks facing in</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

        <span class="n">ms</span> <span class="o">=</span> <span class="n">marker_cycle</span><span class="p">()</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">color_cycle</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">set_min</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">set_max</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">*</span><span class="mf">1.1</span>

        <span class="k">if</span> <span class="n">x_axis</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">const_to_plot</span><span class="p">:</span>
                <span class="n">r_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="p">]</span>
                <span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">midas_output</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_output</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
                            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for φ = </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">. Substituting 0&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">include_complement</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Cannot find complement to angle &gt; 180. Skipping&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">r_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">[</span><span class="n">angle</span><span class="o">+</span><span class="mi">180</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">midas_output</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">r</span><span class="p">)</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_output</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
                                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for φ = </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">. Substituting 0&quot;</span><span class="p">)</span>

                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">vals</span><span class="p">))]</span>
                <span class="n">rs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
                    
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">rs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s1">°&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">cs</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">ms</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">set_min</span><span class="p">,</span> <span class="n">set_max</span><span class="p">)</span>
            
        
        <span class="k">elif</span> <span class="n">x_axis</span> <span class="o">==</span> <span class="s1">&#39;phi&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$r/R$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">rtarget</span> <span class="ow">in</span> <span class="n">const_to_plot</span><span class="p">:</span>
                <span class="n">phis</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">rstar</span><span class="p">,</span> <span class="n">midas_output</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rstar</span> <span class="o">-</span> <span class="n">rtarget</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
                            <span class="n">phis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_output</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                            <span class="k">except</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rstar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
                                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for φ = </span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, r = </span><span class="si">{</span><span class="n">rstar</span><span class="si">}</span><span class="s2">. Substituting 0&quot;</span><span class="p">)</span>

                <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">vals</span><span class="p">))]</span>
                <span class="n">phis</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">phis</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rotate</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">phis</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">rtarget</span><span class="si">:</span><span class="s1">0.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">cs</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">ms</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">rtarget</span><span class="si">:</span><span class="s1">0.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">cs</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">ms</span><span class="p">),</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rotate</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">set_min</span><span class="p">,</span> <span class="n">set_max</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">set_min</span><span class="p">,</span> <span class="n">set_max</span><span class="p">)</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;invalid axis for plot_profiles: </span><span class="si">{</span><span class="n">x_axis</span><span class="si">}</span><span class="s2">. Current supported options are &#39;r&#39; and &#39;phi&#39;&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="n">label_str</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span>
                <span class="n">label_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\alpha\ [-]$&#39;</span>
            <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;ai&#39;</span><span class="p">:</span>
                <span class="n">label_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$a_</span><span class="si">{i}</span><span class="s1">\ [1/m]$&#39;</span>
            <span class="k">elif</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;ug1&#39;</span><span class="p">:</span>
                <span class="n">label_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$v_</span><span class="si">{g}</span><span class="s1">\ [m/s]$&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label_str</span> <span class="o">=</span> <span class="n">param</span>
        
        <span class="k">if</span> <span class="n">x_axis</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
            <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_str</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">xlabel_loc</span><span class="p">)</span>
            <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r/R$ [-]&#39;</span><span class="p">)</span>
            <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
            <span class="c1">#fake_ax.set_xticks(np.linspace(self.min(param), self.max(param), 7))</span>

        <span class="k">elif</span> <span class="n">x_axis</span> <span class="o">==</span> <span class="s1">&#39;phi&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">rotate</span><span class="p">:</span>
                <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label_str</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">xlabel_loc</span><span class="p">)</span>
                <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\varphi$ [-]&#39;</span><span class="p">)</span>

                <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">360</span><span class="p">])</span>
                <span class="c1">#fake_ax.set_yticks(np.linspace(self.min(param), self.max(param), 7))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_str</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">xlabel_loc</span><span class="p">)</span>
                <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\varphi$ [-]&#39;</span><span class="p">)</span>
                
                <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">360</span><span class="p">])</span>
                <span class="c1"># fake_ax.set_xticks(np.linspace(self.min(param), self.max(param), 7))</span>

                <span class="c1">#fake_ax.tick_params(axis=&#39;both&#39;, labelrotation=-self.theta)</span>
        
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>


        <span class="k">if</span> <span class="n">set_min</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">set_max</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">force_RH_y_axis</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">set_min</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">show_spines</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">log_x</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">nonzero</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">param</span><span class="p">)</span><span class="o">*</span><span class="mf">1.2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">rotate</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">fake_ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xlabel_loc_coords</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">*</span><span class="n">xlabel_loc_coords</span><span class="p">)</span>

        <span class="n">fake_ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">,</span> <span class="n">share</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;datalim&#39;</span><span class="p">,</span> <span class="n">share</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#fake_ax.set_box_aspect(1)</span>
        
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">_profile_vs_</span><span class="si">{</span><span class="n">x_axis</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span>   </div>


<div class="viewcode-block" id="Condition.plot_isoline">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.plot_isoline">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_isoline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">iso_axis</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">iso_val</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">plot_res</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> 
                     <span class="n">save_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extra_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Plot profiles of param over iso_axis at iso_val </span>
<span class="sd">        </span>
<span class="sd">        Based on interpolation, so plot_res changes the resolution</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;compressed&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Times New Roman&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;mathtext.fontset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cm&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">iso_axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="n">lim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">iso_val</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">,</span> <span class="n">plot_res</span><span class="p">)</span>
            <span class="n">xs</span> <span class="o">=</span> <span class="n">iso_val</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ys</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="bp">self</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">interp_method</span> <span class="o">=</span> <span class="s1">&#39;linear_xy&#39;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">marker_color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_style</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y/R$ [-]&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">iso_axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">lim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">iso_val</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">,</span> <span class="n">plot_res</span><span class="p">)</span>
            <span class="n">ys</span> <span class="o">=</span> <span class="n">iso_val</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">interp_method</span> <span class="o">=</span> <span class="s1">&#39;linear_xy&#39;</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">marker_color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_style</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x/R$ [-]&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">_iso_</span><span class="si">{</span><span class="n">iso_axis</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">iso_val</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">extra_text</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.plot_contour">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.plot_contour">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">set_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">set_min</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">label_str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">suppress_colorbar</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                     <span class="n">rot_angle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ngridr</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">ngridphi</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s1">&#39;hot_r&#39;</span><span class="p">,</span> <span class="n">num_levels</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">level_step</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">title_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">extra_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                     <span class="n">annotate_h</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cartesian</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">h_star_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;max_dsm&#39;</span><span class="p">,</span> <span class="s1">&#39;min_void&#39;</span><span class="p">:</span> <span class="s1">&#39;0.05&#39;</span><span class="p">},</span> <span class="n">plot_measured_points</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method to plot contour of a given param</span>
<span class="sd">        </span>
<span class="sd">        Generates a contour plot of any parameter in midas_dict, e.g. &#39;alpha&#39;, &#39;ai&#39;, etc. By default, just shows the figure,</span>
<span class="sd">        but if a save_dir is specified, it will save it there instead. label_str can adjust the label of the colorbar. Can accept Latex format, e.g.</span>
<span class="sd">        r&quot;$\alpha$ [-]&quot;</span>

<span class="sd">        set_max and set_min set the bounds of the contour plot, and the colormap option allows for any colors that matplotlib supports. ngridr, ngridphi,</span>
<span class="sd">        num_levels, all adjust how fine the contour plot is generated.</span>

<span class="sd">        annotate_h is an option to draw a horizontal line at some given position. This was implemented when investigating where the bubble layer typically</span>
<span class="sd">        stops. h_star_kwargs and cartesian are optinos related to this.</span>

<span class="sd">        plot_measured points is neat, it plots circles where original data was detected (determined prior to mirroring)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Times New Roman&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;mathtext.fontset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cm&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">phi_angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">midas_output</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    <span class="n">phis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi_angle</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_output</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
                            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for φ = </span><span class="si">{</span><span class="n">phi_angle</span><span class="si">}</span><span class="s2">, r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">. Substituting 0&quot;</span><span class="p">)</span>

        <span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phis</span><span class="p">)</span> <span class="o">+</span> <span class="n">rot_angle</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> 
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>   

        <span class="n">ri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ngridr</span><span class="p">)</span>
        <span class="n">phii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rot_angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">rot_angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">ngridphi</span><span class="p">)</span>

        <span class="n">triang</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span>
        <span class="n">interpolator</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">LinearTriInterpolator</span><span class="p">(</span> <span class="n">triang</span><span class="p">,</span> <span class="n">vals</span> <span class="p">)</span>

        <span class="n">PHII</span><span class="p">,</span> <span class="n">RI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">phii</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>
        <span class="n">XI</span> <span class="o">=</span> <span class="n">RI</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHII</span><span class="p">)</span>
        <span class="n">YI</span> <span class="o">=</span> <span class="n">RI</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHII</span><span class="p">)</span>
        <span class="n">parami</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">PHII</span><span class="p">,</span> <span class="n">RI</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">debug</span> <span class="ow">and</span> <span class="kc">False</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1"> to contour plot&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span> <span class="n">Yi</span><span class="p">,</span> <span class="n">alphai</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">debugFID</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;max </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">alphai</span><span class="p">),</span> <span class="n">file</span> <span class="o">=</span> <span class="n">debugFID</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">param</span> <span class="o">==</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;contour_error_dump_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="c1">#print(vals)</span>
            <span class="k">raise</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Alpha exceeds 1.0!</span><span class="se">\n</span><span class="s1">Saving problematic array&#39;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha exceeds 1.0!</span><span class="se">\n</span><span class="s1">Saving problematic array&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="n">extend_min</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">extend_max</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="n">set_min</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">parami</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_max</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">parami</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">parami</span><span class="p">):</span>
            <span class="n">extend_min</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">set_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">parami</span><span class="p">):</span>
            <span class="n">extend_max</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">extend_max</span> <span class="ow">and</span> <span class="n">extend_min</span><span class="p">:</span>
            <span class="n">extend_opt</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span>
        <span class="k">elif</span> <span class="n">extend_min</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">extend_max</span> <span class="ow">and</span> <span class="n">set_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">parami</span><span class="p">):</span>
            <span class="n">extend_opt</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>
        <span class="k">elif</span> <span class="n">extend_max</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">extend_min</span><span class="p">:</span>
            <span class="n">extend_opt</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">extend_min</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">extend_max</span><span class="p">:</span>
            <span class="n">extend_opt</span> <span class="o">=</span> <span class="s1">&#39;neither&#39;</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">set_max</span> <span class="o">-</span> <span class="n">set_min</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">level_step</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Warning: Level step </span><span class="si">{</span><span class="n">level_step</span><span class="si">}</span><span class="s1"> too larger for range </span><span class="si">{</span><span class="n">set_max</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">set_min</span><span class="si">}</span><span class="s1">. Defaulting to 0.01*(set_max - set_min)&#39;</span><span class="p">)</span>
            <span class="n">level_step</span> <span class="o">=</span> <span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">set_max</span> <span class="o">-</span> <span class="n">set_min</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">num_levels</span><span class="p">:</span>
            <span class="n">lvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">set_min</span><span class="p">,</span> <span class="n">set_max</span><span class="p">,</span> <span class="n">num_levels</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">set_max</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">):</span> <span class="c1"># if the max is 0, start the counting from there</span>
                <span class="n">lvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">set_max</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">set_min</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">level_step</span><span class="p">)</span>
                <span class="n">lvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">lvs</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">set_min</span><span class="p">,</span> <span class="n">set_max</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">level_step</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
            <span class="n">mpbl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">XI</span><span class="p">,</span> <span class="n">YI</span><span class="p">,</span> <span class="n">parami</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">lvs</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">set_min</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">set_max</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
            <span class="c1"># Make a circle to look nice</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mpbl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">PHII</span><span class="p">,</span> <span class="n">RI</span><span class="p">,</span> <span class="n">parami</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">lvs</span><span class="p">,</span> 
                               <span class="n">vmin</span> <span class="o">=</span> <span class="n">set_min</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">set_max</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="n">extend_opt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">plot_measured_points</span><span class="p">:</span> 
                <span class="c1"># print(np.asarray(self.original_mesh)[:,0]* np.pi/180 , np.asarray(self.original_mesh)[:,1])</span>
                <span class="n">measured_thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_mesh</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
                <span class="n">measured_rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_mesh</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_mesh</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">measured_rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">measured_rs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">measured_thetas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">measured_thetas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">measured_thetas</span><span class="p">,</span> <span class="n">measured_rs</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">fillstyle</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">mec</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">annotate_h</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cartesian</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: annotate_h assumes that we&#39;re plotting in Cartesian. Annotation may not be correct&quot;</span><span class="p">)</span>
            <span class="n">hstar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_hstar_pos</span><span class="p">(</span><span class="o">**</span><span class="n">h_star_kwargs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> 
                    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span>
        <span class="p">)</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x/R$ [-]&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y/R$ [-]&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

        <span class="c1">#plt.clim(vmin=set_min, vmax=set_max)</span>
        
        <span class="k">if</span> <span class="n">label_str</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">label_str</span> <span class="o">=</span> <span class="n">param</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">suppress_colorbar</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpbl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_str</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">title_str</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">title_str</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title_str</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        
        <span class="c1">#cb = plt.colorbar(ticks = [0, 0.05, 0.1, 0.15, 0.2])</span>

        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">_contours_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">extra_text</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.plot_surface">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.plot_surface">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rotate_gif</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">elev_angle</span> <span class="o">=</span> <span class="mi">145</span><span class="p">,</span> 
                     <span class="n">azim_angle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">roll_angle</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ngridr</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">ngridphi</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> 
                     <span class="n">plot_surface_kwargs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">solid_color</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">label_str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method to plot a surface of a given param</span>
<span class="sd">        </span>
<span class="sd">        Can save a static image or rotating gif, starting at elev_angle, azim_angle, roll_angle. These angles also </span>
<span class="sd">        the viewing angle for the static image.</span>

<span class="sd">        Can specify a label or title str.</span>

<span class="sd">        Plot_surface_kwargs is how to specify vmin, vmax, colormap, etc.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span> 
        
        <span class="k">if</span> <span class="n">plot_surface_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot_surface_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Times New Roman&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;mathtext.fontset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cm&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror</span><span class="p">()</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">phi_angle</span><span class="p">,</span> <span class="n">r_dict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">midas_output</span> <span class="ow">in</span> <span class="n">r_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    <span class="n">phis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi_angle</span><span class="p">)</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">midas_output</span><span class="p">[</span><span class="n">param</span><span class="p">])</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> for φ = </span><span class="si">{</span><span class="n">phi_angle</span><span class="si">}</span><span class="s2">, r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">. Substituting NaN&quot;</span><span class="p">)</span>

        <span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
        <span class="n">phis</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">phis</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> 
        <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>   

        <span class="n">ri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ngridr</span><span class="p">)</span>
        <span class="n">phii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">ngridphi</span><span class="p">)</span>

        <span class="n">triang</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span>
        <span class="n">interpolator</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">LinearTriInterpolator</span><span class="p">(</span> <span class="n">triang</span><span class="p">,</span> <span class="n">vals</span> <span class="p">)</span>

        <span class="n">PHII</span><span class="p">,</span> <span class="n">RI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">phii</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>
        <span class="n">parami</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">PHII</span><span class="p">,</span> <span class="n">RI</span><span class="p">)</span>

        <span class="n">Xi</span> <span class="o">=</span> <span class="n">RI</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHII</span><span class="p">)</span>
        <span class="n">Yi</span> <span class="o">=</span> <span class="n">RI</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHII</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;3d&quot;</span><span class="p">})</span>

        <span class="k">if</span> <span class="s1">&#39;vmin&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_surface_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
            <span class="n">plot_surface_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">param</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;vmax&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_surface_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
            <span class="n">plot_surface_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">param</span><span class="p">)})</span>

        <span class="k">if</span> <span class="s1">&#39;cmap&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">plot_surface_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">solid_color</span><span class="p">:</span> 
            <span class="n">plot_surface_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="s1">&#39;viridis&#39;</span><span class="p">})</span>

        <span class="n">surf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span> <span class="n">Yi</span><span class="p">,</span> <span class="n">parami</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_surface_kwargs</span><span class="p">)</span>
        

        <span class="c1">#plt.legend()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x/R$ [-]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y/R$ [-]&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="n">plot_surface_kwargs</span><span class="p">[</span><span class="s1">&#39;vmin&#39;</span><span class="p">],</span> <span class="n">plot_surface_kwargs</span><span class="p">[</span><span class="s1">&#39;vmax&#39;</span><span class="p">]])</span>

        
        <span class="k">if</span> <span class="n">label_str</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">label_str</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_str</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">title_str</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title_str</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">azim</span><span class="o">=</span><span class="n">azim_angle</span><span class="p">,</span> <span class="n">roll</span><span class="o">=</span><span class="n">roll_angle</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="n">elev_angle</span><span class="p">)</span>
               
        <span class="c1">#cb = plt.colorbar(ticks = [0, 0.05, 0.1, 0.15, 0.2])</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">_surface_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span> <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">rotate_gif</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="nn">animation</span>
            
            <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">azim</span><span class="o">=</span><span class="n">angle</span><span class="p">)</span>
            
            <span class="n">rot_animation</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">rotate</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">362</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">rot_animation</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s1">_surface_rotation_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.gif&#39;</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.plot_spline_contour">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.plot_spline_contour">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_spline_contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">save_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">set_max</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">set_min</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                     <span class="n">rot_angle</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ngridr</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">ngridphi</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s1">&#39;hot_r&#39;</span><span class="p">,</span> <span class="n">num_levels</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                     <span class="n">annotate_h</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cartesian</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">h_star_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;max_dsm&#39;</span><span class="p">,</span> <span class="s1">&#39;min_void&#39;</span><span class="p">:</span> <span class="s1">&#39;0.05&#39;</span><span class="p">},</span>
                     <span class="n">grad</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots a contour from a spline interpolation</span>

<span class="sd">        Will fit the spline if necessary. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span> 
        
        <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> not found in spline_interp dict, running fit_spline&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fit_spline</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>

        <span class="n">phii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">phii_arg</span> <span class="o">=</span> <span class="n">phii</span> <span class="o">+</span> <span class="n">rot_angle</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;font.family&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Times New Roman&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;mathtext.fontset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cm&quot;</span>

        <span class="n">PHII</span><span class="p">,</span> <span class="n">RI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">phii</span><span class="p">,</span> <span class="n">ri</span><span class="p">)</span>
        <span class="n">XI</span> <span class="o">=</span> <span class="n">RI</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHII</span><span class="p">)</span>
        <span class="n">YI</span> <span class="o">=</span> <span class="n">RI</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHII</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">grad</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">VALS</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phii_arg</span><span class="p">,</span> <span class="n">ri</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">grad</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
            <span class="n">VALS</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phii_arg</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">grad</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
            <span class="n">VALS</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phii_arg</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">grad</span> <span class="o">==</span> <span class="s1">&#39;phi&#39;</span><span class="p">:</span>
            <span class="n">VALS</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">RI</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phii_arg</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">grad</span> <span class="o">==</span> <span class="s1">&#39;phinor&#39;</span><span class="p">:</span>
            <span class="n">VALS</span> <span class="o">=</span>  <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="n">param</span><span class="p">](</span><span class="n">phii_arg</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="k">elif</span> <span class="n">grad</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">VALS</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">](</span><span class="n">phii_arg</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phii_arg</span><span class="p">)</span><span class="o">*</span><span class="n">ri</span> <span class="o">/</span> <span class="p">(</span><span class="n">ri</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mf">1e-8</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">spline_interp</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">](</span><span class="n">phii_arg</span><span class="p">,</span> <span class="n">ri</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phii_arg</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: unrecognized grad type </span><span class="si">{</span><span class="n">grad</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">XI</span><span class="p">,</span> <span class="n">YI</span><span class="p">,</span> <span class="n">VALS</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">num_levels</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">set_min</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">set_max</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
            <span class="c1"># Make a circle to look nice</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">PHII</span><span class="p">,</span> <span class="n">RI</span><span class="p">,</span> <span class="n">VALS</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">num_levels</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">set_min</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">set_max</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">annotate_h</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cartesian</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: annotate_h assumes that we&#39;re plotting in Cartesian. Annotation may not be correct&quot;</span><span class="p">)</span>
            <span class="n">hstar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_hstar_pos</span><span class="p">(</span><span class="o">**</span><span class="n">h_star_kwargs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> 
                    <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span> 
                    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">hstar</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">headwidth</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span>
        <span class="p">)</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cartesian</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x/R$ [-]&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y/R$ [-]&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>

        <span class="k">if</span> <span class="n">grad</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">param_label</span> <span class="o">=</span> <span class="n">param</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">param_label</span> <span class="o">=</span> <span class="s2">&quot;grad_&quot;</span> <span class="o">+</span> <span class="n">param</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">grad</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">param_label</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        
        <span class="c1">#cb = plt.colorbar(ticks = [0, 0.05, 0.1, 0.15, 0.2])</span>

        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">param_label</span><span class="si">}</span><span class="s2">_spline_contours_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.rough_FR_ID">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.rough_FR_ID">[docs]</a>
    <span class="k">def</span> <span class="nf">rough_FR_ID</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identifies the flow regime for the given condition, by some rough methods</span>

<span class="sd">        First checks if it matches any given by previous researchers, or the hierarchical</span>
<span class="sd">        clustering algorithm results</span>

<span class="sd">        Stored in self.FR</span>

<span class="sd">        1 = bubbly</span>
<span class="sd">        2 = plug</span>
<span class="sd">        3 = slug</span>
<span class="sd">        4 = churn</span>
<span class="sd">        5 = stratified</span>
<span class="sd">        6 = stratified wavy</span>
<span class="sd">        7 = annular</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span> 

        <span class="c1"># These values are taken from the respective theses where the data comes from</span>
               
        <span class="n">drew_frid</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.186</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.333</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="mf">0.111</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>  <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">1.0</span><span class="p">,</span>   <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">2</span><span class="p">),</span>
            
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.186</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.333</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="mf">0.111</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>  <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">1.0</span><span class="p">,</span>   <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span>

            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.186</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.333</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="mf">0.111</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="c1">#I changed this, because the point was a consistent outlier</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>  <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">1.0</span><span class="p">,</span>   <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span>

            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.186</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.333</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>  <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">1.0</span><span class="p">,</span>   <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">2</span><span class="p">),</span>

            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.186</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>    <span class="mf">0.333</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span>  <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>  <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>    <span class="mf">1.0</span><span class="p">,</span>   <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>    <span class="mf">0.33</span><span class="p">,</span>  <span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">kong_frid</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span>  <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.327</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span>   <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">0.297</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.575</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.189</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.332</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.329</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.040</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">0.799</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">1.030</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>

            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.186</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.00</span><span class="p">,</span> <span class="mf">0.105</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.00</span><span class="p">,</span> <span class="mf">0.167</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.00</span><span class="p">,</span> <span class="mf">0.327</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">0.089</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">0.149</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">0.297</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">0.575</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.00</span><span class="p">,</span> <span class="mf">0.575</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">1.000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.00</span><span class="p">,</span> <span class="mf">1.000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.330</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.50</span><span class="p">,</span> <span class="mf">0.332</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.00</span><span class="p">,</span> <span class="mf">0.327</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.507</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">1.000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">3.000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">0.330</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">0.575</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">1.000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">3.000</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.330</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">talley_frid</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
            <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="c1"># This one is taken from David&#39;s hierarchical clustering algorithm results</span>
        <span class="n">frid</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">20.7</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">20.4</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">19.6</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">19.3</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">18.6</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">18.2</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">17.6</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.18</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">14.7</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">0.11</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.186</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.33</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">21.2</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">22.5</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">21.7</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">19.9</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">20.9</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">20.2</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">25.0</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">15.5</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  				  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">21.2</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">20.9</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">6.72</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">20.1</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">6.73</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">19.3</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">6.75</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">19.8</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">6.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">18.2</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">2.12</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">6.78</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">16.7</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">2.14</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">13.5</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">26.4</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">23.8</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">23.1</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">22.4</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">20.6</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">20.1</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">19.1</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">15.1</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">21.5</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">20.2</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">18.2</span>  <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">6</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>   
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">6</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.186</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.33</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.07</span>  <span class="p">,</span><span class="mi">5</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.24</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.186</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.33</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.02</span>  <span class="p">,</span><span class="mi">2</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.76</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">7.81</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">17.99</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">2.44</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.186</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.33</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.13</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.43</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">1.36</span>  <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">4.37</span>  <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">13.98</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.04</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.186</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.33</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.048</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.158</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.531</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.719</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">5.541</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">17.66</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.047</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.159</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.538</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.729</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">5.577</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">17.57</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.047</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.161</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.537</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">1.724</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">5.562</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">17.39</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.047</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.158</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.536</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">1.725</span> <span class="p">,</span><span class="mi">3</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">5.564</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">17.36</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.047</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.051</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.051</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">0.048</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.046</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.127</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.209</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.372</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">0.131</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.136</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">20.74</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mf">9.870</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">20.50</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">9.899</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">21.75</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">9.916</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">22.60</span> <span class="p">,</span><span class="mi">7</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">9.941</span> <span class="p">,</span><span class="mi">4</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.186</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">0.33</span>  <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">),</span>  
            <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.111</span> <span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
        <span class="p">]</span>


        <span class="k">for</span> <span class="n">theta_ID</span><span class="p">,</span> <span class="n">jf_ID</span><span class="p">,</span> <span class="n">jg_ID</span><span class="p">,</span> <span class="n">FR_ID</span> <span class="ow">in</span> <span class="n">drew_frid</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="n">theta_ID</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">-</span> <span class="n">jf_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">-</span> <span class="n">jg_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="n">FR_ID</span>
                    <span class="k">return</span>

        <span class="k">for</span> <span class="n">theta_ID</span><span class="p">,</span> <span class="n">jf_ID</span><span class="p">,</span> <span class="n">jg_ID</span><span class="p">,</span> <span class="n">FR_ID</span> <span class="ow">in</span> <span class="n">kong_frid</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="n">theta_ID</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">-</span> <span class="n">jf_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">-</span> <span class="n">jg_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="n">FR_ID</span>
                    <span class="k">return</span>

        <span class="k">for</span> <span class="n">theta_ID</span><span class="p">,</span> <span class="n">jf_ID</span><span class="p">,</span> <span class="n">jg_ID</span><span class="p">,</span> <span class="n">FR_ID</span> <span class="ow">in</span> <span class="n">talley_frid</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="n">theta_ID</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">-</span> <span class="n">jf_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">-</span> <span class="n">jg_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="n">FR_ID</span>
                    <span class="k">return</span>
                
        <span class="k">for</span> <span class="n">theta_ID</span><span class="p">,</span> <span class="n">jf_ID</span><span class="p">,</span> <span class="n">jg_ID</span><span class="p">,</span> <span class="n">FR_ID</span> <span class="ow">in</span> <span class="n">frid</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="n">theta_ID</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">-</span> <span class="n">jf_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">-</span> <span class="n">jg_ID</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="n">FR_ID</span>
                    <span class="k">return</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">&gt;</span> <span class="mf">3.4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jgloc</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">jf</span> <span class="o">&lt;</span> <span class="mf">3.7</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FR</span> <span class="o">=</span> <span class="mi">2</span>
        
        <span class="c1">#print(f&quot;Warning: Flow regime not accurately identified for {self.name}, defaulting to {self.FR}&quot;)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Condition.TD_FR_ID">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.Condition.TD_FR_ID">[docs]</a>
    <span class="k">def</span> <span class="nf">TD_FR_ID</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#dpdxL</span>

        <span class="k">return</span></div>
</div>



<div class="viewcode-block" id="color_cycle">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.color_cycle">[docs]</a>
<span class="k">def</span> <span class="nf">color_cycle</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom generator for colors</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">var_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#0000FF&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#FF0000&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#00FF00&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#00FFFF&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#7F00FF&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#7FFF7F&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#007F7F&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#7F007F&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#7F7F7F&#39;</span><span class="p">,</span>
                <span class="s1">&#39;#000000&#39;</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">var_list</span><span class="p">[</span> <span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_list</span><span class="p">)]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="marker_cycle">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.marker_cycle">[docs]</a>
<span class="k">def</span> <span class="nf">marker_cycle</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom generator for markers</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">var_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">var_list</span><span class="p">[</span> <span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_list</span><span class="p">)]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="print_tab_keys">
<a class="viewcode-back" href="../../MARIGOLD.html#MARIGOLD.Condition.print_tab_keys">[docs]</a>
<span class="k">def</span> <span class="nf">print_tab_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convenience function in case you forget a tab key</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)</span>
    <span class="k">return</span></div>


<span class="n">tab_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;frequency&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_G1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_G2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_total&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bub_freq&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pair_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;percent_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_G1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_G2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_slug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_G1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_G2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Lcl1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Lcl2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fluctuation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_ug&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_Dsm1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_Dsm2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r02&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r03&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r12&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r13&#39;</span><span class="p">,</span>
    <span class="s1">&#39;r23&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;jf_loc&#39;</span><span class="p">,</span>
    <span class="s1">&#39;jf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delta_p&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_delta_p&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vr&#39;</span>
<span class="p">]</span>

<span class="n">old_tab_keys</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;roverR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_total&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bub_freq&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;obs_3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;percent_paired&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_spherical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_distorted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai_cap&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ai&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dsm2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sigma_ug2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fluctuation_ug&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">zero_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">tab_keys</span><span class="p">)))</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, adix.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>